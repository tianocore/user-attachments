From 82e0e8d5f745bcd02df0a0499cc6567037774a78 Mon Sep 17 00:00:00 2001
From: Jeremiah Cox <jerecox@ntdev.microsoft.com>
Date: Tue, 2 Mar 2021 17:32:35 -0800
Subject: [PATCH] Adding a host based unit test demonstrating a bug with
 Pkcs7GetSigners().

---
 ...eMicrosoftKekPkcs7Signature_asn_decode.txt | 612 ++++++++++++++++++
 .../Library/BaseCryptLib/RsaPkcs7Tests.c      | 436 ++++++++++++-
 2 files changed, 1047 insertions(+), 1 deletion(-)
 create mode 100644 CryptoPkg/Test/UnitTest/Library/BaseCryptLib/ExampleMicrosoftKekPkcs7Signature_asn_decode.txt

diff --git a/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/ExampleMicrosoftKekPkcs7Signature_asn_decode.txt b/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/ExampleMicrosoftKekPkcs7Signature_asn_decode.txt
new file mode 100644
index 0000000000..9274d37d5a
--- /dev/null
+++ b/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/ExampleMicrosoftKekPkcs7Signature_asn_decode.txt
@@ -0,0 +1,612 @@
+0000: 30 82 0c f3				; SEQUENCE (cf3 Bytes)
+0004:    02 01					; INTEGER (1 Bytes)
+0006:    |  01
+0007:    31 0f					; SET (f Bytes)
+0009:    |  30 0d				; SEQUENCE (d Bytes)
+000b:    |     06 09				; OBJECT_ID (9 Bytes)
+000d:    |     |  60 86 48 01 65 03 04 02  01
+         |     |     ; 2.16.840.1.101.3.4.2.1 sha256 (sha256NoSign)
+0016:    |     05 00				; NULL (0 Bytes)
+0018:    30 0b					; SEQUENCE (b Bytes)
+001a:    |  06 09				; OBJECT_ID (9 Bytes)
+001c:    |     2a 86 48 86 f7 0d 01 07  01
+         |        ; 1.2.840.113549.1.7.1 PKCS 7 Data
+0025:    a0 82 0b 06				; Certificates! (b06 Bytes)
+0029:    |  30 82 05 16				; SEQUENCE (516 Bytes)      ! first the leaf Key Exchange Key certificate issued under the KEK CA
+002d:    |  |  30 82 03 fe			; SEQUENCE (3fe Bytes)
+0031:    |  |  |  a0 03				; OPTIONAL[0] (3 Bytes)
+0033:    |  |  |  |  02 01			; INTEGER (1 Bytes)
+0035:    |  |  |  |     02
+0036:    |  |  |  02 13				; INTEGER (13 Bytes)       ! serial number of signer certificate
+0038:    |  |  |  |  33 00 00 00 12 6e 4c f7  64 5c db 88 81 00 00 00
+0048:    |  |  |  |  00 00 12
+004b:    |  |  |  30 0d				; SEQUENCE (d Bytes)
+004d:    |  |  |  |  06 09			; OBJECT_ID (9 Bytes)
+004f:    |  |  |  |  |  2a 86 48 86 f7 0d 01 01  0b
+         |  |  |  |  |     ; 1.2.840.113549.1.1.11 sha256RSA
+0058:    |  |  |  |  05 00			; NULL (0 Bytes)
+005a:    |  |  |  30 81 80			; SEQUENCE (80 Bytes)
+005d:    |  |  |  |  31 0b			; SET (b Bytes)
+005f:    |  |  |  |  |  30 09			; SEQUENCE (9 Bytes)
+0061:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0063:    |  |  |  |  |     |  55 04 06
+         |  |  |  |  |     |     ; 2.5.4.6 Country/Region (C)
+0066:    |  |  |  |  |     13 02		; PRINTABLE_STRING (2 Bytes)
+0068:    |  |  |  |  |        55 53                                             ; US
+         |  |  |  |  |           ; "US"
+006a:    |  |  |  |  31 13			; SET (13 Bytes)
+006c:    |  |  |  |  |  30 11			; SEQUENCE (11 Bytes)
+006e:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0070:    |  |  |  |  |     |  55 04 08
+         |  |  |  |  |     |     ; 2.5.4.8 State Or Province (S)
+0073:    |  |  |  |  |     13 0a		; PRINTABLE_STRING (a Bytes)
+0075:    |  |  |  |  |        57 61 73 68 69 6e 67 74  6f 6e                    ; Washington
+         |  |  |  |  |           ; "Washington"
+007f:    |  |  |  |  31 10			; SET (10 Bytes)
+0081:    |  |  |  |  |  30 0e			; SEQUENCE (e Bytes)
+0083:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0085:    |  |  |  |  |     |  55 04 07
+         |  |  |  |  |     |     ; 2.5.4.7 Locality (L)
+0088:    |  |  |  |  |     13 07		; PRINTABLE_STRING (7 Bytes)
+008a:    |  |  |  |  |        52 65 64 6d 6f 6e 64                              ; Redmond
+         |  |  |  |  |           ; "Redmond"
+0091:    |  |  |  |  31 1e			; SET (1e Bytes)
+0093:    |  |  |  |  |  30 1c			; SEQUENCE (1c Bytes)
+0095:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0097:    |  |  |  |  |     |  55 04 0a
+         |  |  |  |  |     |     ; 2.5.4.10 Organization (O)
+009a:    |  |  |  |  |     13 15		; PRINTABLE_STRING (15 Bytes)
+009c:    |  |  |  |  |        4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+00ac:    |  |  |  |  |        61 74 69 6f 6e                                    ; ation
+         |  |  |  |  |           ; "Microsoft Corporation"
+00b1:    |  |  |  |  31 2a			; SET (2a Bytes)
+00b3:    |  |  |  |     30 28			; SEQUENCE (28 Bytes)
+00b5:    |  |  |  |        06 03		; OBJECT_ID (3 Bytes)
+00b7:    |  |  |  |        |  55 04 03
+         |  |  |  |        |     ; 2.5.4.3 Common Name (CN)
+00ba:    |  |  |  |        13 21		; PRINTABLE_STRING (21 Bytes)
+00bc:    |  |  |  |           4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+00cc:    |  |  |  |           61 74 69 6f 6e 20 4b 45  4b 20 43 41 20 32 30 31  ; ation KEK CA 201
+00dc:    |  |  |  |           31                                                ; 1
+         |  |  |  |              ; "Microsoft Corporation KEK CA 2011"
+00dd:    |  |  |  30 1e				; SEQUENCE (1e Bytes)
+00df:    |  |  |  |  17 0d			; UTC_TIME (d Bytes)
+00e1:    |  |  |  |  |  31 36 30 31 30 36 31 38  33 34 31 35 5a           ; 160106183415Z
+         |  |  |  |  |     ;  1/6/16 10:34
+00ee:    |  |  |  |  17 0d			; UTC_TIME (d Bytes)
+00f0:    |  |  |  |     31 37 30 34 30 36 31 38  33 34 31 35 5a           ; 170406183415Z
+         |  |  |  |        ;  4/6/17 10:34
+00fd:    |  |  |  30 81 94			; SEQUENCE (94 Bytes)
+0100:    |  |  |  |  31 0b			; SET (b Bytes)
+0102:    |  |  |  |  |  30 09			; SEQUENCE (9 Bytes)
+0104:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0106:    |  |  |  |  |     |  55 04 06
+         |  |  |  |  |     |     ; 2.5.4.6 Country/Region (C)
+0109:    |  |  |  |  |     13 02		; PRINTABLE_STRING (2 Bytes)
+010b:    |  |  |  |  |        55 53                                             ; US
+         |  |  |  |  |           ; "US"
+010d:    |  |  |  |  31 13			; SET (13 Bytes)
+010f:    |  |  |  |  |  30 11			; SEQUENCE (11 Bytes)
+0111:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0113:    |  |  |  |  |     |  55 04 08
+         |  |  |  |  |     |     ; 2.5.4.8 State Or Province (S)
+0116:    |  |  |  |  |     13 0a		; PRINTABLE_STRING (a Bytes)
+0118:    |  |  |  |  |        57 61 73 68 69 6e 67 74  6f 6e                    ; Washington
+         |  |  |  |  |           ; "Washington"
+0122:    |  |  |  |  31 10			; SET (10 Bytes)
+0124:    |  |  |  |  |  30 0e			; SEQUENCE (e Bytes)
+0126:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0128:    |  |  |  |  |     |  55 04 07
+         |  |  |  |  |     |     ; 2.5.4.7 Locality (L)
+012b:    |  |  |  |  |     13 07		; PRINTABLE_STRING (7 Bytes)
+012d:    |  |  |  |  |        52 65 64 6d 6f 6e 64                              ; Redmond
+         |  |  |  |  |           ; "Redmond"
+0134:    |  |  |  |  31 1e			; SET (1e Bytes)
+0136:    |  |  |  |  |  30 1c			; SEQUENCE (1c Bytes)
+0138:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+013a:    |  |  |  |  |     |  55 04 0a
+         |  |  |  |  |     |     ; 2.5.4.10 Organization (O)
+013d:    |  |  |  |  |     13 15		; PRINTABLE_STRING (15 Bytes)
+013f:    |  |  |  |  |        4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+014f:    |  |  |  |  |        61 74 69 6f 6e                                    ; ation
+         |  |  |  |  |           ; "Microsoft Corporation"
+0154:    |  |  |  |  31 0c			; SET (c Bytes)
+0156:    |  |  |  |  |  30 0a			; SEQUENCE (a Bytes)
+0158:    |  |  |  |  |     06 03		; OBJECT_ID (3 Bytes)
+015a:    |  |  |  |  |     |  55 04 0b
+         |  |  |  |  |     |     ; 2.5.4.11 Organizational Unit (OU)
+015d:    |  |  |  |  |     13 03		; PRINTABLE_STRING (3 Bytes)
+015f:    |  |  |  |  |        41 4f 43                                          ; AOC
+         |  |  |  |  |           ; "AOC"
+0162:    |  |  |  |  31 30			; SET (30 Bytes)
+0164:    |  |  |  |     30 2e			; SEQUENCE (2e Bytes)
+0166:    |  |  |  |        06 03		; OBJECT_ID (3 Bytes)
+0168:    |  |  |  |        |  55 04 03
+         |  |  |  |        |     ; 2.5.4.3 Common Name (CN)
+016b:    |  |  |  |        13 27		; PRINTABLE_STRING (27 Bytes)
+016d:    |  |  |  |           4d 69 63 72 6f 73 6f 66  74 20 57 69 6e 64 6f 77  ; Microsoft Window
+017d:    |  |  |  |           73 20 55 45 46 49 20 4b  65 79 20 45 78 63 68 61  ; s UEFI Key Excha
+018d:    |  |  |  |           6e 67 65 20 4b 65 79                              ; nge Key
+         |  |  |  |              ; "Microsoft Windows UEFI Key Exchange Key"
+0194:    |  |  |  30 82 01 22			; SEQUENCE (122 Bytes)
+0198:    |  |  |  |  30 0d			; SEQUENCE (d Bytes)
+019a:    |  |  |  |  |  06 09			; OBJECT_ID (9 Bytes)
+019c:    |  |  |  |  |  |  2a 86 48 86 f7 0d 01 01  01
+         |  |  |  |  |  |     ; 1.2.840.113549.1.1.1 RSA (RSA_SIGN)
+01a5:    |  |  |  |  |  05 00			; NULL (0 Bytes)
+01a7:    |  |  |  |  03 82 01 0f		; BIT_STRING (10f Bytes)
+01ab:    |  |  |  |     00
+01ac:    |  |  |  |     30 82 01 0a		; SEQUENCE (10a Bytes)
+01b0:    |  |  |  |        02 82 01 01		; INTEGER (101 Bytes)
+01b4:    |  |  |  |        |  00
+01b5:    |  |  |  |        |  c5 2b 0d 48 1b 34 f2 03  86 83 be 6e 83 b6 08 99
+01c5:    |  |  |  |        |  30 26 9d 6f 05 8b b9 0f  36 74 6e 54 f8 b8 e1 41
+01d5:    |  |  |  |        |  8a 2e 35 30 ac 4c 71 ac  a5 91 3f dd e2 fc ca 09
+01e5:    |  |  |  |        |  2a 7a 42 94 5e 19 71 99  91 74 49 82 41 c6 a5 f8
+01f5:    |  |  |  |        |  92 88 da e2 6a 4c 61 26  02 30 ec 0e 6c 47 a2 01
+0205:    |  |  |  |        |  75 0c ff e5 36 8f 8f 3a  21 a6 34 1c f6 bc 45 60
+0215:    |  |  |  |        |  25 e4 58 74 53 51 02 52  81 28 87 df 27 68 f3 53
+0225:    |  |  |  |        |  77 a9 34 30 5f e0 14 96  b7 2b 25 35 c2 15 c1 df
+0235:    |  |  |  |        |  36 7a ab e8 bf 5d 25 23  0d de 28 52 f0 5e e9 73
+0245:    |  |  |  |        |  09 e3 fd 43 11 b5 48 dc  d5 c8 4a 6b 38 1f 3d 06
+0255:    |  |  |  |        |  8b 97 16 e2 66 7f 90 ca  62 e4 a0 f6 f5 38 31 43
+0265:    |  |  |  |        |  c0 e4 19 0b a9 2f c4 8d  7b 4e e6 6e 10 b9 5b c1
+0275:    |  |  |  |        |  99 7c 5c e1 0d ec 88 cf  db b5 63 ee 9a ba ee b9
+0285:    |  |  |  |        |  c1 ef b3 4e 7a 4d ff 6f  79 51 ce e9 32 b8 95 a1
+0295:    |  |  |  |        |  29 c4 f7 d7 b0 cc 97 84  1c 9a 78 1c 60 71 1f c7
+02a5:    |  |  |  |        |  84 ee f0 27 32 13 26 3a  ff 23 3d c2 1a 62 9d 73
+02b5:    |  |  |  |        02 03		; INTEGER (3 Bytes)
+02b7:    |  |  |  |           01 00 01
+02ba:    |  |  |  a3 82 01 71			; OPTIONAL[3] (171 Bytes)
+02be:    |  |  |     30 82 01 6d		; SEQUENCE (16d Bytes)
+02c2:    |  |  |        30 14			; SEQUENCE (14 Bytes)
+02c4:    |  |  |        |  06 03		; OBJECT_ID (3 Bytes)
+02c6:    |  |  |        |  |  55 1d 25
+         |  |  |        |  |     ; 2.5.29.37 Enhanced Key Usage
+02c9:    |  |  |        |  04 0d		; OCTET_STRING (d Bytes)
+02cb:    |  |  |        |     30 0b		; SEQUENCE (b Bytes)
+02cd:    |  |  |        |        06 09		; OBJECT_ID (9 Bytes)
+02cf:    |  |  |        |           2b 06 01 04 01 82 37 4f  01
+         |  |  |        |              ; 1.3.6.1.4.1.311.79.1
+02d8:    |  |  |        30 1d			; SEQUENCE (1d Bytes)
+02da:    |  |  |        |  06 03		; OBJECT_ID (3 Bytes)
+02dc:    |  |  |        |  |  55 1d 0e
+         |  |  |        |  |     ; 2.5.29.14 Subject Key Identifier
+02df:    |  |  |        |  04 16		; OCTET_STRING (16 Bytes)
+02e1:    |  |  |        |     04 14		; OCTET_STRING (14 Bytes)
+02e3:    |  |  |        |        6d 1d 9c 90 10 95 3b 41  d0 0e 58 6a 80 0b 12 de  ; m.....;A..Xj....
+02f3:    |  |  |        |        f9 3d 82 7d                                       ; .=.}
+02f7:    |  |  |        30 50			; SEQUENCE (50 Bytes)
+02f9:    |  |  |        |  06 03		; OBJECT_ID (3 Bytes)
+02fb:    |  |  |        |  |  55 1d 11
+         |  |  |        |  |     ; 2.5.29.17 Subject Alternative Name
+02fe:    |  |  |        |  04 49		; OCTET_STRING (49 Bytes)
+0300:    |  |  |        |     30 47		; SEQUENCE (47 Bytes)
+0302:    |  |  |        |        a4 45		; OPTIONAL[4] (45 Bytes)
+0304:    |  |  |        |           30 43	; SEQUENCE (43 Bytes)
+0306:    |  |  |        |              31 0c	; SET (c Bytes)
+0308:    |  |  |        |              |  30 0a	; SEQUENCE (a Bytes)
+030a:    |  |  |        |              |     06 03	; OBJECT_ID (3 Bytes)
+030c:    |  |  |        |              |     |  55 04 0b
+         |  |  |        |              |     |     ; 2.5.4.11 Organizational Unit (OU)
+030f:    |  |  |        |              |     13 03	; PRINTABLE_STRING (3 Bytes)
+0311:    |  |  |        |              |        41 4f 43                                          ; AOC
+         |  |  |        |              |           ; "AOC"
+0314:    |  |  |        |              31 33	; SET (33 Bytes)
+0316:    |  |  |        |                 30 31	; SEQUENCE (31 Bytes)
+0318:    |  |  |        |                    06 03	; OBJECT_ID (3 Bytes)
+031a:    |  |  |        |                    |  55 04 05
+         |  |  |        |                    |     ; 2.5.4.5 Serial Number (SERIALNUMBER)
+031d:    |  |  |        |                    13 2a	; PRINTABLE_STRING (2a Bytes)
+031f:    |  |  |        |                       33 31 36 33 31 2b 32 63  34 35 36 63 62 63 2d 30  ; 31631+2c456cbc-0
+032f:    |  |  |        |                       35 34 32 2d 34 37 64 39  2d 39 39 65 35 2d 64 33  ; 542-47d9-99e5-d3
+033f:    |  |  |        |                       39 62 38 31 35 63 35 37  33 65                    ; 9b815c573e
+         |  |  |        |                          ; "31631+2c456cbc-0542-47d9-99e5-d39b815c573e"
+0349:    |  |  |        30 1f			; SEQUENCE (1f Bytes)
+034b:    |  |  |        |  06 03		; OBJECT_ID (3 Bytes)
+034d:    |  |  |        |  |  55 1d 23
+         |  |  |        |  |     ; 2.5.29.35 Authority Key Identifier
+0350:    |  |  |        |  04 18		; OCTET_STRING (18 Bytes)
+0352:    |  |  |        |     30 16		; SEQUENCE (16 Bytes)
+0354:    |  |  |        |        80 14		; CONTEXT_SPECIFIC[0] (14 Bytes)
+0356:    |  |  |        |           62 fc 43 cd a0 3e a4 cb  67 12 d2 5b d9 55 ac 7b  ; b.C..>..g..[.U.{
+0366:    |  |  |        |           cc b6 8a 5f                                       ; ..._
+036a:    |  |  |        30 53			; SEQUENCE (53 Bytes)
+036c:    |  |  |        |  06 03		; OBJECT_ID (3 Bytes)
+036e:    |  |  |        |  |  55 1d 1f
+         |  |  |        |  |     ; 2.5.29.31 CRL Distribution Points
+0371:    |  |  |        |  04 4c		; OCTET_STRING (4c Bytes)
+0373:    |  |  |        |     30 4a		; SEQUENCE (4a Bytes)
+0375:    |  |  |        |        30 48		; SEQUENCE (48 Bytes)
+0377:    |  |  |        |           a0 46	; OPTIONAL[0] (46 Bytes)
+0379:    |  |  |        |              a0 44	; OPTIONAL[0] (44 Bytes)
+037b:    |  |  |        |                 86 42	; CONTEXT_SPECIFIC[6] (42 Bytes)
+037d:    |  |  |        |                    68 74 74 70 3a 2f 2f 77  77 77 2e 6d 69 63 72 6f  ; http://www.micro
+038d:    |  |  |        |                    73 6f 66 74 2e 63 6f 6d  2f 70 6b 69 6f 70 73 2f  ; soft.com/pkiops/
+039d:    |  |  |        |                    63 72 6c 2f 4d 69 63 43  6f 72 4b 45 4b 43 41 32  ; crl/MicCorKEKCA2
+03ad:    |  |  |        |                    30 31 31 5f 32 30 31 31  2d 30 36 2d 32 34 2e 63  ; 011_2011-06-24.c
+03bd:    |  |  |        |                    72 6c                                             ; rl
+03bf:    |  |  |        30 60			; SEQUENCE (60 Bytes)
+03c1:    |  |  |        |  06 08		; OBJECT_ID (8 Bytes)
+03c3:    |  |  |        |  |  2b 06 01 05 05 07 01 01
+         |  |  |        |  |     ; 1.3.6.1.5.5.7.1.1 Authority Information Access
+03cb:    |  |  |        |  04 54		; OCTET_STRING (54 Bytes)
+03cd:    |  |  |        |     30 52		; SEQUENCE (52 Bytes)
+03cf:    |  |  |        |        30 50		; SEQUENCE (50 Bytes)
+03d1:    |  |  |        |           06 08	; OBJECT_ID (8 Bytes)
+03d3:    |  |  |        |           |  2b 06 01 05 05 07 30 02
+         |  |  |        |           |     ; 1.3.6.1.5.5.7.48.2 Certification Authority Issuer
+03db:    |  |  |        |           86 44	; CONTEXT_SPECIFIC[6] (44 Bytes)
+03dd:    |  |  |        |              68 74 74 70 3a 2f 2f 77  77 77 2e 6d 69 63 72 6f  ; http://www.micro
+03ed:    |  |  |        |              73 6f 66 74 2e 63 6f 6d  2f 70 6b 69 6f 70 73 2f  ; soft.com/pkiops/
+03fd:    |  |  |        |              63 65 72 74 73 2f 4d 69  63 43 6f 72 4b 45 4b 43  ; certs/MicCorKEKC
+040d:    |  |  |        |              41 32 30 31 31 5f 32 30  31 31 2d 30 36 2d 32 34  ; A2011_2011-06-24
+041d:    |  |  |        |              2e 63 72 74                                       ; .crt
+0421:    |  |  |        30 0c			; SEQUENCE (c Bytes)
+0423:    |  |  |           06 03		; OBJECT_ID (3 Bytes)
+0425:    |  |  |           |  55 1d 13
+         |  |  |           |     ; 2.5.29.19 Basic Constraints
+0428:    |  |  |           01 01		; BOOL (1 Bytes)
+042a:    |  |  |           |  ff
+042b:    |  |  |           04 02		; OCTET_STRING (2 Bytes)
+042d:    |  |  |              30 00		; SEQUENCE (0 Bytes)
+042f:    |  |  30 0d				; SEQUENCE (d Bytes)
+0431:    |  |  |  06 09				; OBJECT_ID (9 Bytes)
+0433:    |  |  |  |  2a 86 48 86 f7 0d 01 01  0b
+         |  |  |  |     ; 1.2.840.113549.1.1.11 sha256RSA
+043c:    |  |  |  05 00				; NULL (0 Bytes)
+043e:    |  |  03 82 01 01			; BIT_STRING (101 Bytes)
+0442:    |  |     00
+0443:    |  |     97 53 e6 8b c4 fe fc 9e  fb 2e 43 0d 49 19 52 a2
+0453:    |  |     05 ee ef 4b 56 35 1f 83  97 4f 30 e4 02 ad 26 51
+0463:    |  |     47 1a 94 5c 97 d5 d0 15  c3 1b 13 ed 45 f7 d7 36
+0473:    |  |     0d 3d 82 f7 e4 ad 12 77  a5 ac 43 3e 90 5a 27 eb
+0483:    |  |     7a ad 36 44 1d 20 8e 0a  18 38 31 a0 bf 25 cb 55
+0493:    |  |     d8 99 ea 66 2e dd cd b1  01 ae 04 49 51 8f 15 a9
+04a3:    |  |     fd 18 fe 4d 9d bb cc 2f  09 06 90 55 76 be 12 64
+04b3:    |  |     b4 63 65 92 2f 3f e5 31  db 2a d1 6e e2 0f dd cd
+04c3:    |  |     99 ac 01 41 ee cc 76 5d  4f 0b 5b 73 3a ea f1 3d
+04d3:    |  |     e6 5d 3f 4c e4 a4 8c 9e  84 eb ed 8d 07 5f 41 9f
+04e3:    |  |     c4 6c 88 1a f8 53 50 1d  90 13 8d 2a f4 16 b7 44
+04f3:    |  |     62 25 52 a1 19 e1 23 b7  a1 c7 c0 43 62 29 26 db
+0503:    |  |     61 55 21 91 d7 6e b4 82  c3 aa 30 0b 24 ca 51 ac
+0513:    |  |     ad 85 dc bf 92 ec 0d 2d  e0 c2 a8 08 58 17 2f 27
+0523:    |  |     94 e1 28 94 45 d8 58 7e  56 d7 0b 30 59 6a 14 da
+0533:    |  |     c2 0c b9 0c 89 6f 93 ca  2c 81 4c 15 12 d4 72 1e
+0543:    |  30 82 05 e8				; SEQUENCE (5e8 Bytes)          ! The Microsoft KEK CA cert, issued by the Third Party Root
+0547:    |     30 82 03 d0			; SEQUENCE (3d0 Bytes)
+054b:    |     |  a0 03				; OPTIONAL[0] (3 Bytes)
+054d:    |     |  |  02 01			; INTEGER (1 Bytes)
+054f:    |     |  |     02
+0550:    |     |  02 0a				; INTEGER (a Bytes)
+0552:    |     |  |  61 0a d1 88 00 00 00 00  00 03
+055c:    |     |  30 0d				; SEQUENCE (d Bytes)
+055e:    |     |  |  06 09			; OBJECT_ID (9 Bytes)
+0560:    |     |  |  |  2a 86 48 86 f7 0d 01 01  0b
+         |     |  |  |     ; 1.2.840.113549.1.1.11 sha256RSA
+0569:    |     |  |  05 00			; NULL (0 Bytes)
+056b:    |     |  30 81 91			; SEQUENCE (91 Bytes)
+056e:    |     |  |  31 0b			; SET (b Bytes)
+0570:    |     |  |  |  30 09			; SEQUENCE (9 Bytes)
+0572:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0574:    |     |  |  |     |  55 04 06
+         |     |  |  |     |     ; 2.5.4.6 Country/Region (C)
+0577:    |     |  |  |     13 02		; PRINTABLE_STRING (2 Bytes)
+0579:    |     |  |  |        55 53                                             ; US
+         |     |  |  |           ; "US"
+057b:    |     |  |  31 13			; SET (13 Bytes)
+057d:    |     |  |  |  30 11			; SEQUENCE (11 Bytes)
+057f:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0581:    |     |  |  |     |  55 04 08
+         |     |  |  |     |     ; 2.5.4.8 State Or Province (S)
+0584:    |     |  |  |     13 0a		; PRINTABLE_STRING (a Bytes)
+0586:    |     |  |  |        57 61 73 68 69 6e 67 74  6f 6e                    ; Washington
+         |     |  |  |           ; "Washington"
+0590:    |     |  |  31 10			; SET (10 Bytes)
+0592:    |     |  |  |  30 0e			; SEQUENCE (e Bytes)
+0594:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0596:    |     |  |  |     |  55 04 07
+         |     |  |  |     |     ; 2.5.4.7 Locality (L)
+0599:    |     |  |  |     13 07		; PRINTABLE_STRING (7 Bytes)
+059b:    |     |  |  |        52 65 64 6d 6f 6e 64                              ; Redmond
+         |     |  |  |           ; "Redmond"
+05a2:    |     |  |  31 1e			; SET (1e Bytes)
+05a4:    |     |  |  |  30 1c			; SEQUENCE (1c Bytes)
+05a6:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+05a8:    |     |  |  |     |  55 04 0a
+         |     |  |  |     |     ; 2.5.4.10 Organization (O)
+05ab:    |     |  |  |     13 15		; PRINTABLE_STRING (15 Bytes)
+05ad:    |     |  |  |        4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+05bd:    |     |  |  |        61 74 69 6f 6e                                    ; ation
+         |     |  |  |           ; "Microsoft Corporation"
+05c2:    |     |  |  31 3b			; SET (3b Bytes)
+05c4:    |     |  |     30 39			; SEQUENCE (39 Bytes)
+05c6:    |     |  |        06 03		; OBJECT_ID (3 Bytes)
+05c8:    |     |  |        |  55 04 03
+         |     |  |        |     ; 2.5.4.3 Common Name (CN)
+05cb:    |     |  |        13 32		; PRINTABLE_STRING (32 Bytes)
+05cd:    |     |  |           4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+05dd:    |     |  |           61 74 69 6f 6e 20 54 68  69 72 64 20 50 61 72 74  ; ation Third Part
+05ed:    |     |  |           79 20 4d 61 72 6b 65 74  70 6c 61 63 65 20 52 6f  ; y Marketplace Ro
+05fd:    |     |  |           6f 74                                             ; ot
+         |     |  |              ; "Microsoft Corporation Third Party Marketplace Root"
+05ff:    |     |  30 1e				; SEQUENCE (1e Bytes)
+0601:    |     |  |  17 0d			; UTC_TIME (d Bytes)
+0603:    |     |  |  |  31 31 30 36 32 34 32 30  34 31 32 39 5a           ; 110624204129Z
+         |     |  |  |     ;  6/24/11 12:41
+0610:    |     |  |  17 0d			; UTC_TIME (d Bytes)
+0612:    |     |  |     32 36 30 36 32 34 32 30  35 31 32 39 5a           ; 260624205129Z
+         |     |  |        ;  6/24/26 12:51
+061f:    |     |  30 81 80			; SEQUENCE (80 Bytes)
+0622:    |     |  |  31 0b			; SET (b Bytes)
+0624:    |     |  |  |  30 09			; SEQUENCE (9 Bytes)
+0626:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0628:    |     |  |  |     |  55 04 06
+         |     |  |  |     |     ; 2.5.4.6 Country/Region (C)
+062b:    |     |  |  |     13 02		; PRINTABLE_STRING (2 Bytes)
+062d:    |     |  |  |        55 53                                             ; US
+         |     |  |  |           ; "US"
+062f:    |     |  |  31 13			; SET (13 Bytes)
+0631:    |     |  |  |  30 11			; SEQUENCE (11 Bytes)
+0633:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0635:    |     |  |  |     |  55 04 08
+         |     |  |  |     |     ; 2.5.4.8 State Or Province (S)
+0638:    |     |  |  |     13 0a		; PRINTABLE_STRING (a Bytes)
+063a:    |     |  |  |        57 61 73 68 69 6e 67 74  6f 6e                    ; Washington
+         |     |  |  |           ; "Washington"
+0644:    |     |  |  31 10			; SET (10 Bytes)
+0646:    |     |  |  |  30 0e			; SEQUENCE (e Bytes)
+0648:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+064a:    |     |  |  |     |  55 04 07
+         |     |  |  |     |     ; 2.5.4.7 Locality (L)
+064d:    |     |  |  |     13 07		; PRINTABLE_STRING (7 Bytes)
+064f:    |     |  |  |        52 65 64 6d 6f 6e 64                              ; Redmond
+         |     |  |  |           ; "Redmond"
+0656:    |     |  |  31 1e			; SET (1e Bytes)
+0658:    |     |  |  |  30 1c			; SEQUENCE (1c Bytes)
+065a:    |     |  |  |     06 03		; OBJECT_ID (3 Bytes)
+065c:    |     |  |  |     |  55 04 0a
+         |     |  |  |     |     ; 2.5.4.10 Organization (O)
+065f:    |     |  |  |     13 15		; PRINTABLE_STRING (15 Bytes)
+0661:    |     |  |  |        4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+0671:    |     |  |  |        61 74 69 6f 6e                                    ; ation
+         |     |  |  |           ; "Microsoft Corporation"
+0676:    |     |  |  31 2a			; SET (2a Bytes)
+0678:    |     |  |     30 28			; SEQUENCE (28 Bytes)
+067a:    |     |  |        06 03		; OBJECT_ID (3 Bytes)
+067c:    |     |  |        |  55 04 03
+         |     |  |        |     ; 2.5.4.3 Common Name (CN)
+067f:    |     |  |        13 21		; PRINTABLE_STRING (21 Bytes)
+0681:    |     |  |           4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+0691:    |     |  |           61 74 69 6f 6e 20 4b 45  4b 20 43 41 20 32 30 31  ; ation KEK CA 201
+06a1:    |     |  |           31                                                ; 1
+         |     |  |              ; "Microsoft Corporation KEK CA 2011"
+06a2:    |     |  30 82 01 22			; SEQUENCE (122 Bytes)
+06a6:    |     |  |  30 0d			; SEQUENCE (d Bytes)
+06a8:    |     |  |  |  06 09			; OBJECT_ID (9 Bytes)
+06aa:    |     |  |  |  |  2a 86 48 86 f7 0d 01 01  01
+         |     |  |  |  |     ; 1.2.840.113549.1.1.1 RSA (RSA_SIGN)
+06b3:    |     |  |  |  05 00			; NULL (0 Bytes)
+06b5:    |     |  |  03 82 01 0f		; BIT_STRING (10f Bytes)
+06b9:    |     |  |     00
+06ba:    |     |  |     30 82 01 0a		; SEQUENCE (10a Bytes)
+06be:    |     |  |        02 82 01 01		; INTEGER (101 Bytes)
+06c2:    |     |  |        |  00
+06c3:    |     |  |        |  c4 e8 b5 8a bf ad 57 26  b0 26 c3 ea e7 fb 57 7a
+06d3:    |     |  |        |  44 02 5d 07 0d da 4a e5  74 2a e6 b0 0f ec 6d eb
+06e3:    |     |  |        |  ec 7f b9 e3 5a 63 32 7c  11 17 4f 0e e3 0b a7 38
+06f3:    |     |  |        |  15 93 8e c6 f5 e0 84 b1  9a 9b 2c e7 f5 b7 91 d6
+0703:    |     |  |        |  09 e1 e2 c0 04 a8 ac 30  1c df 48 f3 06 50 9a 64
+0713:    |     |  |        |  a7 51 7f c8 85 4f 8f 20  86 ce fe 2f e1 9f ff 82
+0723:    |     |  |        |  c0 ed e9 cd ce f4 53 6a  62 3a 0b 43 b9 e2 25 fd
+0733:    |     |  |        |  fe 05 f9 d4 c4 14 ab 11  e2 23 89 8d 70 b7 a4 1d
+0743:    |     |  |        |  4d ec ae e5 9c fa 16 c2  d7 c1 cb d4 e8 c4 2f e5
+0753:    |     |  |        |  99 ee 24 8b 03 ec 8d f2  8b ea c3 4a fb 43 11 12
+0763:    |     |  |        |  0b 7e b5 47 92 6c dc e6  04 89 eb f5 33 04 eb 10
+0773:    |     |  |        |  01 2a 71 e5 f9 83 13 3c  ff 25 09 2f 68 76 46 ff
+0783:    |     |  |        |  ba 4f be dc ad 71 2a 58  aa fb 0e d2 79 3d e4 9b
+0793:    |     |  |        |  65 3b cc 29 2a 9f fc 72  59 a2 eb ae 92 ef f6 35
+07a3:    |     |  |        |  13 80 c6 02 ec e4 5f cc  9d 76 cd ef 63 92 c1 af
+07b3:    |     |  |        |  79 40 84 79 87 7f e3 52  a8 e8 9d 7b 07 69 8f 15
+07c3:    |     |  |        02 03		; INTEGER (3 Bytes)
+07c5:    |     |  |           01 00 01
+07c8:    |     |  a3 82 01 4f			; OPTIONAL[3] (14f Bytes)
+07cc:    |     |     30 82 01 4b		; SEQUENCE (14b Bytes)
+07d0:    |     |        30 10			; SEQUENCE (10 Bytes)
+07d2:    |     |        |  06 09		; OBJECT_ID (9 Bytes)
+07d4:    |     |        |  |  2b 06 01 04 01 82 37 15  01
+         |     |        |  |     ; 1.3.6.1.4.1.311.21.1 CA Version
+07dd:    |     |        |  04 03		; OCTET_STRING (3 Bytes)
+07df:    |     |        |     02 01		; INTEGER (1 Bytes)
+07e1:    |     |        |        00
+07e2:    |     |        30 1d			; SEQUENCE (1d Bytes)
+07e4:    |     |        |  06 03		; OBJECT_ID (3 Bytes)
+07e6:    |     |        |  |  55 1d 0e
+         |     |        |  |     ; 2.5.29.14 Subject Key Identifier
+07e9:    |     |        |  04 16		; OCTET_STRING (16 Bytes)
+07eb:    |     |        |     04 14		; OCTET_STRING (14 Bytes)
+07ed:    |     |        |        62 fc 43 cd a0 3e a4 cb  67 12 d2 5b d9 55 ac 7b  ; b.C..>..g..[.U.{
+07fd:    |     |        |        cc b6 8a 5f                                       ; ..._
+0801:    |     |        30 19			; SEQUENCE (19 Bytes)
+0803:    |     |        |  06 09		; OBJECT_ID (9 Bytes)
+0805:    |     |        |  |  2b 06 01 04 01 82 37 14  02
+         |     |        |  |     ; 1.3.6.1.4.1.311.20.2 Certificate Template Name (Certificate Type)
+080e:    |     |        |  04 0c		; OCTET_STRING (c Bytes)
+0810:    |     |        |     1e 0a 00 53 00 75 00 62  00 43 00 41              ; ...S.u.b.C.A
+081c:    |     |        30 0b			; SEQUENCE (b Bytes)
+081e:    |     |        |  06 03		; OBJECT_ID (3 Bytes)
+0820:    |     |        |  |  55 1d 0f
+         |     |        |  |     ; 2.5.29.15 Key Usage
+0823:    |     |        |  04 04		; OCTET_STRING (4 Bytes)
+0825:    |     |        |     03 02		; BIT_STRING (2 Bytes)
+0827:    |     |        |        01
+0828:    |     |        |        86
+0829:    |     |        30 0f			; SEQUENCE (f Bytes)
+082b:    |     |        |  06 03		; OBJECT_ID (3 Bytes)
+082d:    |     |        |  |  55 1d 13
+         |     |        |  |     ; 2.5.29.19 Basic Constraints
+0830:    |     |        |  01 01		; BOOL (1 Bytes)
+0832:    |     |        |  |  ff
+0833:    |     |        |  04 05		; OCTET_STRING (5 Bytes)
+0835:    |     |        |     30 03		; SEQUENCE (3 Bytes)
+0837:    |     |        |        01 01		; BOOL (1 Bytes)
+0839:    |     |        |           ff
+083a:    |     |        30 1f			; SEQUENCE (1f Bytes)
+083c:    |     |        |  06 03		; OBJECT_ID (3 Bytes)
+083e:    |     |        |  |  55 1d 23
+         |     |        |  |     ; 2.5.29.35 Authority Key Identifier
+0841:    |     |        |  04 18		; OCTET_STRING (18 Bytes)
+0843:    |     |        |     30 16		; SEQUENCE (16 Bytes)
+0845:    |     |        |        80 14		; CONTEXT_SPECIFIC[0] (14 Bytes)
+0847:    |     |        |           45 66 52 43 e1 7e 58 11  bf d6 4e 9e 23 55 08 3b  ; EfRC.~X...N.#U.;
+0857:    |     |        |           3a 22 6a a8                                       ; :"j.
+085b:    |     |        30 5c			; SEQUENCE (5c Bytes)
+085d:    |     |        |  06 03		; OBJECT_ID (3 Bytes)
+085f:    |     |        |  |  55 1d 1f
+         |     |        |  |     ; 2.5.29.31 CRL Distribution Points
+0862:    |     |        |  04 55		; OCTET_STRING (55 Bytes)
+0864:    |     |        |     30 53		; SEQUENCE (53 Bytes)
+0866:    |     |        |        30 51		; SEQUENCE (51 Bytes)
+0868:    |     |        |           a0 4f	; OPTIONAL[0] (4f Bytes)
+086a:    |     |        |              a0 4d	; OPTIONAL[0] (4d Bytes)
+086c:    |     |        |                 86 4b	; CONTEXT_SPECIFIC[6] (4b Bytes)
+086e:    |     |        |                    68 74 74 70 3a 2f 2f 63  72 6c 2e 6d 69 63 72 6f  ; http://crl.micro
+087e:    |     |        |                    73 6f 66 74 2e 63 6f 6d  2f 70 6b 69 2f 63 72 6c  ; soft.com/pki/crl
+088e:    |     |        |                    2f 70 72 6f 64 75 63 74  73 2f 4d 69 63 43 6f 72  ; /products/MicCor
+089e:    |     |        |                    54 68 69 50 61 72 4d 61  72 52 6f 6f 5f 32 30 31  ; ThiParMarRoo_201
+08ae:    |     |        |                    30 2d 31 30 2d 30 35 2e  63 72 6c                 ; 0-10-05.crl
+08b9:    |     |        30 60			; SEQUENCE (60 Bytes)
+08bb:    |     |           06 08		; OBJECT_ID (8 Bytes)
+08bd:    |     |           |  2b 06 01 05 05 07 01 01
+         |     |           |     ; 1.3.6.1.5.5.7.1.1 Authority Information Access
+08c5:    |     |           04 54		; OCTET_STRING (54 Bytes)
+08c7:    |     |              30 52		; SEQUENCE (52 Bytes)
+08c9:    |     |                 30 50		; SEQUENCE (50 Bytes)
+08cb:    |     |                    06 08	; OBJECT_ID (8 Bytes)
+08cd:    |     |                    |  2b 06 01 05 05 07 30 02
+         |     |                    |     ; 1.3.6.1.5.5.7.48.2 Certification Authority Issuer
+08d5:    |     |                    86 44	; CONTEXT_SPECIFIC[6] (44 Bytes)
+08d7:    |     |                       68 74 74 70 3a 2f 2f 77  77 77 2e 6d 69 63 72 6f  ; http://www.micro
+08e7:    |     |                       73 6f 66 74 2e 63 6f 6d  2f 70 6b 69 2f 63 65 72  ; soft.com/pki/cer
+08f7:    |     |                       74 73 2f 4d 69 63 43 6f  72 54 68 69 50 61 72 4d  ; ts/MicCorThiParM
+0907:    |     |                       61 72 52 6f 6f 5f 32 30  31 30 2d 31 30 2d 30 35  ; arRoo_2010-10-05
+0917:    |     |                       2e 63 72 74                                       ; .crt
+091b:    |     30 0d				; SEQUENCE (d Bytes)
+091d:    |     |  06 09				; OBJECT_ID (9 Bytes)
+091f:    |     |  |  2a 86 48 86 f7 0d 01 01  0b
+         |     |  |     ; 1.2.840.113549.1.1.11 sha256RSA
+0928:    |     |  05 00				; NULL (0 Bytes)
+092a:    |     03 82 02 01			; BIT_STRING (201 Bytes)
+092e:    |        00
+092f:    |        d4 84 88 f5 14 94 18 02  ca 2a 3c fb 2a 92 1c 0c
+093f:    |        d7 a0 d1 f1 e8 52 66 a8  ee a2 b5 75 7a 90 00 aa
+094f:    |        2d a4 76 5a ea 79 b7 b9  37 6a 51 7b 10 64 f6 e1
+095f:    |        64 f2 02 67 be f7 a8 1b  78 bd ba ce 88 58 64 0c
+096f:    |        d6 57 c8 19 a3 5f 05 d6  db c6 d0 69 ce 48 4b 32
+097f:    |        b7 eb 5d d2 30 f5 c0 f5  b8 ba 78 07 a3 2b fe 9b
+098f:    |        db 34 56 84 ec 82 ca ae  41 25 70 9c 6b e9 fe 90
+099f:    |        0f d7 96 1f e5 e7 94 1f  b2 2a 0c 8d 4b ff 28 29
+09af:    |        10 7b f7 d7 7c a5 d1 76  b9 05 c8 79 ed 0f 90 92
+09bf:    |        9c c2 fe df 6f 7e 6c 0f  7b d4 c1 45 dd 34 51 96
+09cf:    |        39 0f e5 5e 56 d8 18 05  96 f4 07 a6 42 b3 a0 77
+09df:    |        fd 08 19 f2 71 56 cc 9f  86 23 a4 87 cb a6 fd 58
+09ef:    |        7e d4 69 67 15 91 7e 81  f2 7f 13 e5 0d 8b 8a 3c
+09ff:    |        87 84 eb e3 ce bd 43 e5  ad 2d 84 93 8e 6a 2b 5a
+0a0f:    |        7c 44 fa 52 aa 81 c8 2d  1c bb e0 52 df 00 11 f8
+0a1f:    |        9a 3d c1 60 b0 e1 33 b5  a3 88 d1 65 19 0a 1a e7
+0a2f:    |        ac 7c a4 c1 82 87 4e 38  b1 2f 0d c5 14 87 6f fd
+0a3f:    |        8d 2e bc 39 b6 e7 e6 c3  e0 e4 cd 27 84 ef 94 42
+0a4f:    |        ef 29 8b 90 46 41 3b 81  1b 67 d8 f9 43 59 65 cb
+0a5f:    |        0d bc fd 00 92 4f f4 75  3b a7 a9 24 fc 50 41 40
+0a6f:    |        79 e0 2d 4f 0a 6a 27 76  6e 52 ed 96 69 7b af 0f
+0a7f:    |        f7 87 05 d0 45 c2 ad 53  14 81 1f fb 30 04 aa 37
+0a8f:    |        36 61 da 4a 69 1b 34 d8  68 ed d6 02 cf 6c 94 0c
+0a9f:    |        d3 cf 6c 22 79 ad b1 f0  bc 03 a2 46 60 a9 c4 07
+0aaf:    |        c2 21 82 f1 fd f2 e8 79  32 60 bf d8 ac a5 22 14
+0abf:    |        4b ca c1 d8 4b eb 7d 3f  57 35 b2 e6 4f 75 b4 b0
+0acf:    |        60 03 22 53 ae 91 79 1d  d6 9b 41 1f 15 86 54 70
+0adf:    |        b2 de 0d 35 0f 7c b0 34  72 ba 97 60 3b f0 79 eb
+0aef:    |        a2 b2 1c 5d a2 16 b8 87  c5 e9 1b f6 b5 97 25 6f
+0aff:    |        38 9f e3 91 fa 8a 79 98  c3 69 0e b7 a3 1c 20 05
+0b0f:    |        97 f8 ca 14 ae 00 d7 c4  f3 c0 14 10 75 6b 34 a0
+0b1f:    |        1b b5 99 60 f3 5c b0 c5  57 4e 36 d2 32 84 bf 9e
+0b2f:    31 82 01 c4				; SET (1c4 Bytes)      ! SignerInfos
+0b33:       30 82 01 c0				; SEQUENCE (1c0 Bytes) ! first and only SignerInfo
+0b37:          02 01				; INTEGER (1 Bytes)
+0b39:          |  01
+0b3a:          30 81 98				; SEQUENCE (98 Bytes)
+0b3d:          |  30 81 80			; SEQUENCE (80 Bytes)
+0b40:          |  |  31 0b			; SET (b Bytes)
+0b42:          |  |  |  30 09			; SEQUENCE (9 Bytes)
+0b44:          |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0b46:          |  |  |     |  55 04 06
+               |  |  |     |     ; 2.5.4.6 Country/Region (C)
+0b49:          |  |  |     13 02		; PRINTABLE_STRING (2 Bytes)
+0b4b:          |  |  |        55 53                                             ; US
+               |  |  |           ; "US"
+0b4d:          |  |  31 13			; SET (13 Bytes)
+0b4f:          |  |  |  30 11			; SEQUENCE (11 Bytes)
+0b51:          |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0b53:          |  |  |     |  55 04 08
+               |  |  |     |     ; 2.5.4.8 State Or Province (S)
+0b56:          |  |  |     13 0a		; PRINTABLE_STRING (a Bytes)
+0b58:          |  |  |        57 61 73 68 69 6e 67 74  6f 6e                    ; Washington
+               |  |  |           ; "Washington"
+0b62:          |  |  31 10			; SET (10 Bytes)
+0b64:          |  |  |  30 0e			; SEQUENCE (e Bytes)
+0b66:          |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0b68:          |  |  |     |  55 04 07
+               |  |  |     |     ; 2.5.4.7 Locality (L)
+0b6b:          |  |  |     13 07		; PRINTABLE_STRING (7 Bytes)
+0b6d:          |  |  |        52 65 64 6d 6f 6e 64                              ; Redmond
+               |  |  |           ; "Redmond"
+0b74:          |  |  31 1e			; SET (1e Bytes)
+0b76:          |  |  |  30 1c			; SEQUENCE (1c Bytes)
+0b78:          |  |  |     06 03		; OBJECT_ID (3 Bytes)
+0b7a:          |  |  |     |  55 04 0a
+               |  |  |     |     ; 2.5.4.10 Organization (O)
+0b7d:          |  |  |     13 15		; PRINTABLE_STRING (15 Bytes)
+0b7f:          |  |  |        4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+0b8f:          |  |  |        61 74 69 6f 6e                                    ; ation
+               |  |  |           ; "Microsoft Corporation"
+0b94:          |  |  31 2a			; SET (2a Bytes)
+0b96:          |  |     30 28			; SEQUENCE (28 Bytes)
+0b98:          |  |        06 03		; OBJECT_ID (3 Bytes)
+0b9a:          |  |        |  55 04 03
+               |  |        |     ; 2.5.4.3 Common Name (CN)
+0b9d:          |  |        13 21		; PRINTABLE_STRING (21 Bytes)
+0b9f:          |  |           4d 69 63 72 6f 73 6f 66  74 20 43 6f 72 70 6f 72  ; Microsoft Corpor
+0baf:          |  |           61 74 69 6f 6e 20 4b 45  4b 20 43 41 20 32 30 31  ; ation KEK CA 201
+0bbf:          |  |           31                                                ; 1
+               |  |              ; "Microsoft Corporation KEK CA 2011"
+0bc0:          |  02 13				; INTEGER (13 Bytes)     ! serial number of signer certificate
+0bc2:          |     33 00 00 00 12 6e 4c f7  64 5c db 88 81 00 00 00
+0bd2:          |     00 00 12
+0bd5:          30 0d				; SEQUENCE (d Bytes)
+0bd7:          |  06 09				; OBJECT_ID (9 Bytes)
+0bd9:          |  |  60 86 48 01 65 03 04 02  01
+               |  |     ; 2.16.840.1.101.3.4.2.1 sha256 (sha256NoSign)
+0be2:          |  05 00				; NULL (0 Bytes)
+0be4:          30 0d				; SEQUENCE (d Bytes)
+0be6:          |  06 09				; OBJECT_ID (9 Bytes)
+0be8:          |  |  2a 86 48 86 f7 0d 01 01  01
+               |  |     ; 1.2.840.113549.1.1.1 RSA (RSA_SIGN) ! the signed digest (not being tested today)
+0bf1:          |  05 00				; NULL (0 Bytes)
+0bf3:          04 82 01 00			; OCTET_STRING (100 Bytes)
+0bf7:             71 21 2c 11 9e 23 a7 98  e5 b9 43 0f 77 d1 e5 c5  ; q!,..#....C.w...
+0c07:             c9 4f 0c 45 c8 29 5a f3  b4 99 4f 48 8d 24 53 35  ; .O.E.)Z...OH.$S5
+0c17:             f1 31 6e 83 51 03 70 3c  59 ee 05 cb 23 53 ca bf  ; .1n.Q.p<Y...#S..
+0c27:             aa 11 cd ae de 98 3f d1  75 cc 69 db 1d f8 1f 09  ; ......?.u.i.....
+0c37:             22 41 80 8c 33 3b 3c 53  b1 df 1d 50 dc 0e 07 c4  ; "A..3;<S...P....
+0c47:             ad 95 c0 97 e3 af 49 31  2a 59 41 91 40 89 60 9c  ; ......I1*YA.@.`.
+0c57:             9f 35 01 8e c1 08 fa 8f  d5 fe 25 a2 fc ac f7 4b  ; .5........%....K
+0c67:             81 40 27 57 c2 5f 41 49  9b dc 7b 8c 05 aa 3e 27  ; .@'W._AI..{...>'
+0c77:             99 7b d1 44 8f ff 1e fc  1e d3 82 08 f6 ae e9 8b  ; .{.D............
+0c87:             4a d2 ce b8 cb b4 ea 23  d8 ac 1a 1d 6d 8b 79 19  ; J......#....m.y.
+0c97:             67 69 28 5d c9 ce 70 8f  2c 07 70 aa 1a 9f 35 03  ; gi(]..p.,.p...5.
+0ca7:             46 37 30 b4 4e 47 8b 03  f4 f7 45 2a 0a 31 5a 0a  ; F70.NG....E*.1Z.
+0cb7:             c6 e3 45 20 05 6a 83 d5  84 49 bf a7 4b d6 12 f7  ; ..E .j...I..K...
+0cc7:             5f 92 37 66 da 3e fe a8  2b e9 17 33 1b 32 47 fd  ; _.7f.>..+..3.2G.
+0cd7:             7d 99 8d 54 6e 96 3b b9  91 45 7c 94 57 e4 ed 93  ; }..Tn.;..E|.W...
+0ce7:             67 46 36 93 5a f7 22 17  74 c7 36 92 8b c4 5e dc  ; gF6.Z.".t.6...^.
+CertUtil: -asn command completed successfully.
diff --git a/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/RsaPkcs7Tests.c b/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/RsaPkcs7Tests.c
index 85a3d6a5a1..49b7582f98 100644
--- a/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/RsaPkcs7Tests.c
+++ b/CryptoPkg/Test/UnitTest/Library/BaseCryptLib/RsaPkcs7Tests.c
@@ -9,6 +9,344 @@
 
 #include "TestBaseCryptLib.h"
 
+// the following is a PKCS7 signature generated using the Microsoft KEK leaf certificate
+// it contains _1_ SignerInfo with a SignerIdentifier of type issuerAndSerialNumber
+// the issuer is the Microsoft KEK CA typically found in the KEK variable
+// Certificates contains:
+// Issuing CA "Microsoft Corporation KEK CA 2011"
+// Leaf       "Microsoft Windows UEFI Key Exchange Key"
+GLOBAL_REMOVE_IF_UNREFERENCED CONST UINT8 ExampleMicrosoftKekPkcs7Signature[] = {
+          0x30, 0x82, 0x0c, 0xf3, 0x02, 0x01, 0x01, 0x31, 0x0f, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86, 0x48,
+          0x01, 0x65, 0x03, 0x04, 0x02, 0x01, 0x05, 0x00, 0x30, 0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
+          0xf7, 0x0d, 0x01, 0x07, 0x01, 0xa0, 0x82, 0x0b, 0x06, 0x30, 0x82, 0x05, 0x16, 0x30, 0x82, 0x03,
+          0xfe, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x13, 0x33, 0x00, 0x00, 0x00, 0x12, 0x6e, 0x4c, 0xf7,
+          0x64, 0x5c, 0xdb, 0x88, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x12, 0x30, 0x0d, 0x06, 0x09, 0x2a,
+          0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x81, 0x80, 0x31, 0x0b, 0x30,
+          0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
+          0x55, 0x04, 0x08, 0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74, 0x6f, 0x6e, 0x31,
+          0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64, 0x6d, 0x6f, 0x6e,
+          0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x15, 0x4d, 0x69, 0x63, 0x72,
+          0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f,
+          0x6e, 0x31, 0x2a, 0x30, 0x28, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x21, 0x4d, 0x69, 0x63, 0x72,
+          0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f,
+          0x6e, 0x20, 0x4b, 0x45, 0x4b, 0x20, 0x43, 0x41, 0x20, 0x32, 0x30, 0x31, 0x31, 0x30, 0x1e, 0x17,
+          0x0d, 0x31, 0x36, 0x30, 0x31, 0x30, 0x36, 0x31, 0x38, 0x33, 0x34, 0x31, 0x35, 0x5a, 0x17, 0x0d,
+          0x31, 0x37, 0x30, 0x34, 0x30, 0x36, 0x31, 0x38, 0x33, 0x34, 0x31, 0x35, 0x5a, 0x30, 0x81, 0x94,
+          0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30,
+          0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74,
+          0x6f, 0x6e, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64,
+          0x6d, 0x6f, 0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x15, 0x4d,
+          0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61,
+          0x74, 0x69, 0x6f, 0x6e, 0x31, 0x0c, 0x30, 0x0a, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x03, 0x41,
+          0x4f, 0x43, 0x31, 0x30, 0x30, 0x2e, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x27, 0x4d, 0x69, 0x63,
+          0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x57, 0x69, 0x6e, 0x64, 0x6f, 0x77, 0x73, 0x20, 0x55,
+          0x45, 0x46, 0x49, 0x20, 0x4b, 0x65, 0x79, 0x20, 0x45, 0x78, 0x63, 0x68, 0x61, 0x6e, 0x67, 0x65,
+          0x20, 0x4b, 0x65, 0x79, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
+          0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a,
+          0x02, 0x82, 0x01, 0x01, 0x00, 0xc5, 0x2b, 0x0d, 0x48, 0x1b, 0x34, 0xf2, 0x03, 0x86, 0x83, 0xbe,
+          0x6e, 0x83, 0xb6, 0x08, 0x99, 0x30, 0x26, 0x9d, 0x6f, 0x05, 0x8b, 0xb9, 0x0f, 0x36, 0x74, 0x6e,
+          0x54, 0xf8, 0xb8, 0xe1, 0x41, 0x8a, 0x2e, 0x35, 0x30, 0xac, 0x4c, 0x71, 0xac, 0xa5, 0x91, 0x3f,
+          0xdd, 0xe2, 0xfc, 0xca, 0x09, 0x2a, 0x7a, 0x42, 0x94, 0x5e, 0x19, 0x71, 0x99, 0x91, 0x74, 0x49,
+          0x82, 0x41, 0xc6, 0xa5, 0xf8, 0x92, 0x88, 0xda, 0xe2, 0x6a, 0x4c, 0x61, 0x26, 0x02, 0x30, 0xec,
+          0x0e, 0x6c, 0x47, 0xa2, 0x01, 0x75, 0x0c, 0xff, 0xe5, 0x36, 0x8f, 0x8f, 0x3a, 0x21, 0xa6, 0x34,
+          0x1c, 0xf6, 0xbc, 0x45, 0x60, 0x25, 0xe4, 0x58, 0x74, 0x53, 0x51, 0x02, 0x52, 0x81, 0x28, 0x87,
+          0xdf, 0x27, 0x68, 0xf3, 0x53, 0x77, 0xa9, 0x34, 0x30, 0x5f, 0xe0, 0x14, 0x96, 0xb7, 0x2b, 0x25,
+          0x35, 0xc2, 0x15, 0xc1, 0xdf, 0x36, 0x7a, 0xab, 0xe8, 0xbf, 0x5d, 0x25, 0x23, 0x0d, 0xde, 0x28,
+          0x52, 0xf0, 0x5e, 0xe9, 0x73, 0x09, 0xe3, 0xfd, 0x43, 0x11, 0xb5, 0x48, 0xdc, 0xd5, 0xc8, 0x4a,
+          0x6b, 0x38, 0x1f, 0x3d, 0x06, 0x8b, 0x97, 0x16, 0xe2, 0x66, 0x7f, 0x90, 0xca, 0x62, 0xe4, 0xa0,
+          0xf6, 0xf5, 0x38, 0x31, 0x43, 0xc0, 0xe4, 0x19, 0x0b, 0xa9, 0x2f, 0xc4, 0x8d, 0x7b, 0x4e, 0xe6,
+          0x6e, 0x10, 0xb9, 0x5b, 0xc1, 0x99, 0x7c, 0x5c, 0xe1, 0x0d, 0xec, 0x88, 0xcf, 0xdb, 0xb5, 0x63,
+          0xee, 0x9a, 0xba, 0xee, 0xb9, 0xc1, 0xef, 0xb3, 0x4e, 0x7a, 0x4d, 0xff, 0x6f, 0x79, 0x51, 0xce,
+          0xe9, 0x32, 0xb8, 0x95, 0xa1, 0x29, 0xc4, 0xf7, 0xd7, 0xb0, 0xcc, 0x97, 0x84, 0x1c, 0x9a, 0x78,
+          0x1c, 0x60, 0x71, 0x1f, 0xc7, 0x84, 0xee, 0xf0, 0x27, 0x32, 0x13, 0x26, 0x3a, 0xff, 0x23, 0x3d,
+          0xc2, 0x1a, 0x62, 0x9d, 0x73, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x71, 0x30, 0x82,
+          0x01, 0x6d, 0x30, 0x14, 0x06, 0x03, 0x55, 0x1d, 0x25, 0x04, 0x0d, 0x30, 0x0b, 0x06, 0x09, 0x2b,
+          0x06, 0x01, 0x04, 0x01, 0x82, 0x37, 0x4f, 0x01, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04,
+          0x16, 0x04, 0x14, 0x6d, 0x1d, 0x9c, 0x90, 0x10, 0x95, 0x3b, 0x41, 0xd0, 0x0e, 0x58, 0x6a, 0x80,
+          0x0b, 0x12, 0xde, 0xf9, 0x3d, 0x82, 0x7d, 0x30, 0x50, 0x06, 0x03, 0x55, 0x1d, 0x11, 0x04, 0x49,
+          0x30, 0x47, 0xa4, 0x45, 0x30, 0x43, 0x31, 0x0c, 0x30, 0x0a, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13,
+          0x03, 0x41, 0x4f, 0x43, 0x31, 0x33, 0x30, 0x31, 0x06, 0x03, 0x55, 0x04, 0x05, 0x13, 0x2a, 0x33,
+          0x31, 0x36, 0x33, 0x31, 0x2b, 0x32, 0x63, 0x34, 0x35, 0x36, 0x63, 0x62, 0x63, 0x2d, 0x30, 0x35,
+          0x34, 0x32, 0x2d, 0x34, 0x37, 0x64, 0x39, 0x2d, 0x39, 0x39, 0x65, 0x35, 0x2d, 0x64, 0x33, 0x39,
+          0x62, 0x38, 0x31, 0x35, 0x63, 0x35, 0x37, 0x33, 0x65, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23,
+          0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x62, 0xfc, 0x43, 0xcd, 0xa0, 0x3e, 0xa4, 0xcb, 0x67, 0x12,
+          0xd2, 0x5b, 0xd9, 0x55, 0xac, 0x7b, 0xcc, 0xb6, 0x8a, 0x5f, 0x30, 0x53, 0x06, 0x03, 0x55, 0x1d,
+          0x1f, 0x04, 0x4c, 0x30, 0x4a, 0x30, 0x48, 0xa0, 0x46, 0xa0, 0x44, 0x86, 0x42, 0x68, 0x74, 0x74,
+          0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66,
+          0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x70, 0x6b, 0x69, 0x6f, 0x70, 0x73, 0x2f, 0x63, 0x72, 0x6c,
+          0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f, 0x72, 0x4b, 0x45, 0x4b, 0x43, 0x41, 0x32, 0x30, 0x31, 0x31,
+          0x5f, 0x32, 0x30, 0x31, 0x31, 0x2d, 0x30, 0x36, 0x2d, 0x32, 0x34, 0x2e, 0x63, 0x72, 0x6c, 0x30,
+          0x60, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x54, 0x30, 0x52, 0x30,
+          0x50, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x44, 0x68, 0x74, 0x74,
+          0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77, 0x77, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66,
+          0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x70, 0x6b, 0x69, 0x6f, 0x70, 0x73, 0x2f, 0x63, 0x65, 0x72,
+          0x74, 0x73, 0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f, 0x72, 0x4b, 0x45, 0x4b, 0x43, 0x41, 0x32, 0x30,
+          0x31, 0x31, 0x5f, 0x32, 0x30, 0x31, 0x31, 0x2d, 0x30, 0x36, 0x2d, 0x32, 0x34, 0x2e, 0x63, 0x72,
+          0x74, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x02, 0x30, 0x00, 0x30,
+          0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82,
+          0x01, 0x01, 0x00, 0x97, 0x53, 0xe6, 0x8b, 0xc4, 0xfe, 0xfc, 0x9e, 0xfb, 0x2e, 0x43, 0x0d, 0x49,
+          0x19, 0x52, 0xa2, 0x05, 0xee, 0xef, 0x4b, 0x56, 0x35, 0x1f, 0x83, 0x97, 0x4f, 0x30, 0xe4, 0x02,
+          0xad, 0x26, 0x51, 0x47, 0x1a, 0x94, 0x5c, 0x97, 0xd5, 0xd0, 0x15, 0xc3, 0x1b, 0x13, 0xed, 0x45,
+          0xf7, 0xd7, 0x36, 0x0d, 0x3d, 0x82, 0xf7, 0xe4, 0xad, 0x12, 0x77, 0xa5, 0xac, 0x43, 0x3e, 0x90,
+          0x5a, 0x27, 0xeb, 0x7a, 0xad, 0x36, 0x44, 0x1d, 0x20, 0x8e, 0x0a, 0x18, 0x38, 0x31, 0xa0, 0xbf,
+          0x25, 0xcb, 0x55, 0xd8, 0x99, 0xea, 0x66, 0x2e, 0xdd, 0xcd, 0xb1, 0x01, 0xae, 0x04, 0x49, 0x51,
+          0x8f, 0x15, 0xa9, 0xfd, 0x18, 0xfe, 0x4d, 0x9d, 0xbb, 0xcc, 0x2f, 0x09, 0x06, 0x90, 0x55, 0x76,
+          0xbe, 0x12, 0x64, 0xb4, 0x63, 0x65, 0x92, 0x2f, 0x3f, 0xe5, 0x31, 0xdb, 0x2a, 0xd1, 0x6e, 0xe2,
+          0x0f, 0xdd, 0xcd, 0x99, 0xac, 0x01, 0x41, 0xee, 0xcc, 0x76, 0x5d, 0x4f, 0x0b, 0x5b, 0x73, 0x3a,
+          0xea, 0xf1, 0x3d, 0xe6, 0x5d, 0x3f, 0x4c, 0xe4, 0xa4, 0x8c, 0x9e, 0x84, 0xeb, 0xed, 0x8d, 0x07,
+          0x5f, 0x41, 0x9f, 0xc4, 0x6c, 0x88, 0x1a, 0xf8, 0x53, 0x50, 0x1d, 0x90, 0x13, 0x8d, 0x2a, 0xf4,
+          0x16, 0xb7, 0x44, 0x62, 0x25, 0x52, 0xa1, 0x19, 0xe1, 0x23, 0xb7, 0xa1, 0xc7, 0xc0, 0x43, 0x62,
+          0x29, 0x26, 0xdb, 0x61, 0x55, 0x21, 0x91, 0xd7, 0x6e, 0xb4, 0x82, 0xc3, 0xaa, 0x30, 0x0b, 0x24,
+          0xca, 0x51, 0xac, 0xad, 0x85, 0xdc, 0xbf, 0x92, 0xec, 0x0d, 0x2d, 0xe0, 0xc2, 0xa8, 0x08, 0x58,
+          0x17, 0x2f, 0x27, 0x94, 0xe1, 0x28, 0x94, 0x45, 0xd8, 0x58, 0x7e, 0x56, 0xd7, 0x0b, 0x30, 0x59,
+          0x6a, 0x14, 0xda, 0xc2, 0x0c, 0xb9, 0x0c, 0x89, 0x6f, 0x93, 0xca, 0x2c, 0x81, 0x4c, 0x15, 0x12,
+          0xd4, 0x72, 0x1e, 0x30, 0x82, 0x05, 0xe8, 0x30, 0x82, 0x03, 0xd0, 0xa0, 0x03, 0x02, 0x01, 0x02,
+          0x02, 0x0a, 0x61, 0x0a, 0xd1, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x30, 0x0d, 0x06, 0x09,
+          0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x30, 0x81, 0x91, 0x31, 0x0b,
+          0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x06,
+          0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74, 0x6f, 0x6e,
+          0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64, 0x6d, 0x6f,
+          0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x15, 0x4d, 0x69, 0x63,
+          0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69,
+          0x6f, 0x6e, 0x31, 0x3b, 0x30, 0x39, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x32, 0x4d, 0x69, 0x63,
+          0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69,
+          0x6f, 0x6e, 0x20, 0x54, 0x68, 0x69, 0x72, 0x64, 0x20, 0x50, 0x61, 0x72, 0x74, 0x79, 0x20, 0x4d,
+          0x61, 0x72, 0x6b, 0x65, 0x74, 0x70, 0x6c, 0x61, 0x63, 0x65, 0x20, 0x52, 0x6f, 0x6f, 0x74, 0x30,
+          0x1e, 0x17, 0x0d, 0x31, 0x31, 0x30, 0x36, 0x32, 0x34, 0x32, 0x30, 0x34, 0x31, 0x32, 0x39, 0x5a,
+          0x17, 0x0d, 0x32, 0x36, 0x30, 0x36, 0x32, 0x34, 0x32, 0x30, 0x35, 0x31, 0x32, 0x39, 0x5a, 0x30,
+          0x81, 0x80, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31,
+          0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e,
+          0x67, 0x74, 0x6f, 0x6e, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52,
+          0x65, 0x64, 0x6d, 0x6f, 0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
+          0x15, 0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f,
+          0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x31, 0x2a, 0x30, 0x28, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13,
+          0x21, 0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f,
+          0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x4b, 0x45, 0x4b, 0x20, 0x43, 0x41, 0x20, 0x32, 0x30,
+          0x31, 0x31, 0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
+          0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02, 0x82,
+          0x01, 0x01, 0x00, 0xc4, 0xe8, 0xb5, 0x8a, 0xbf, 0xad, 0x57, 0x26, 0xb0, 0x26, 0xc3, 0xea, 0xe7,
+          0xfb, 0x57, 0x7a, 0x44, 0x02, 0x5d, 0x07, 0x0d, 0xda, 0x4a, 0xe5, 0x74, 0x2a, 0xe6, 0xb0, 0x0f,
+          0xec, 0x6d, 0xeb, 0xec, 0x7f, 0xb9, 0xe3, 0x5a, 0x63, 0x32, 0x7c, 0x11, 0x17, 0x4f, 0x0e, 0xe3,
+          0x0b, 0xa7, 0x38, 0x15, 0x93, 0x8e, 0xc6, 0xf5, 0xe0, 0x84, 0xb1, 0x9a, 0x9b, 0x2c, 0xe7, 0xf5,
+          0xb7, 0x91, 0xd6, 0x09, 0xe1, 0xe2, 0xc0, 0x04, 0xa8, 0xac, 0x30, 0x1c, 0xdf, 0x48, 0xf3, 0x06,
+          0x50, 0x9a, 0x64, 0xa7, 0x51, 0x7f, 0xc8, 0x85, 0x4f, 0x8f, 0x20, 0x86, 0xce, 0xfe, 0x2f, 0xe1,
+          0x9f, 0xff, 0x82, 0xc0, 0xed, 0xe9, 0xcd, 0xce, 0xf4, 0x53, 0x6a, 0x62, 0x3a, 0x0b, 0x43, 0xb9,
+          0xe2, 0x25, 0xfd, 0xfe, 0x05, 0xf9, 0xd4, 0xc4, 0x14, 0xab, 0x11, 0xe2, 0x23, 0x89, 0x8d, 0x70,
+          0xb7, 0xa4, 0x1d, 0x4d, 0xec, 0xae, 0xe5, 0x9c, 0xfa, 0x16, 0xc2, 0xd7, 0xc1, 0xcb, 0xd4, 0xe8,
+          0xc4, 0x2f, 0xe5, 0x99, 0xee, 0x24, 0x8b, 0x03, 0xec, 0x8d, 0xf2, 0x8b, 0xea, 0xc3, 0x4a, 0xfb,
+          0x43, 0x11, 0x12, 0x0b, 0x7e, 0xb5, 0x47, 0x92, 0x6c, 0xdc, 0xe6, 0x04, 0x89, 0xeb, 0xf5, 0x33,
+          0x04, 0xeb, 0x10, 0x01, 0x2a, 0x71, 0xe5, 0xf9, 0x83, 0x13, 0x3c, 0xff, 0x25, 0x09, 0x2f, 0x68,
+          0x76, 0x46, 0xff, 0xba, 0x4f, 0xbe, 0xdc, 0xad, 0x71, 0x2a, 0x58, 0xaa, 0xfb, 0x0e, 0xd2, 0x79,
+          0x3d, 0xe4, 0x9b, 0x65, 0x3b, 0xcc, 0x29, 0x2a, 0x9f, 0xfc, 0x72, 0x59, 0xa2, 0xeb, 0xae, 0x92,
+          0xef, 0xf6, 0x35, 0x13, 0x80, 0xc6, 0x02, 0xec, 0xe4, 0x5f, 0xcc, 0x9d, 0x76, 0xcd, 0xef, 0x63,
+          0x92, 0xc1, 0xaf, 0x79, 0x40, 0x84, 0x79, 0x87, 0x7f, 0xe3, 0x52, 0xa8, 0xe8, 0x9d, 0x7b, 0x07,
+          0x69, 0x8f, 0x15, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x4f, 0x30, 0x82, 0x01, 0x4b,
+          0x30, 0x10, 0x06, 0x09, 0x2b, 0x06, 0x01, 0x04, 0x01, 0x82, 0x37, 0x15, 0x01, 0x04, 0x03, 0x02,
+          0x01, 0x00, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x62, 0xfc, 0x43,
+          0xcd, 0xa0, 0x3e, 0xa4, 0xcb, 0x67, 0x12, 0xd2, 0x5b, 0xd9, 0x55, 0xac, 0x7b, 0xcc, 0xb6, 0x8a,
+          0x5f, 0x30, 0x19, 0x06, 0x09, 0x2b, 0x06, 0x01, 0x04, 0x01, 0x82, 0x37, 0x14, 0x02, 0x04, 0x0c,
+          0x1e, 0x0a, 0x00, 0x53, 0x00, 0x75, 0x00, 0x62, 0x00, 0x43, 0x00, 0x41, 0x30, 0x0b, 0x06, 0x03,
+          0x55, 0x1d, 0x0f, 0x04, 0x04, 0x03, 0x02, 0x01, 0x86, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13,
+          0x01, 0x01, 0xff, 0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d,
+          0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0x45, 0x66, 0x52, 0x43, 0xe1, 0x7e, 0x58, 0x11, 0xbf,
+          0xd6, 0x4e, 0x9e, 0x23, 0x55, 0x08, 0x3b, 0x3a, 0x22, 0x6a, 0xa8, 0x30, 0x5c, 0x06, 0x03, 0x55,
+          0x1d, 0x1f, 0x04, 0x55, 0x30, 0x53, 0x30, 0x51, 0xa0, 0x4f, 0xa0, 0x4d, 0x86, 0x4b, 0x68, 0x74,
+          0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f,
+          0x66, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x70, 0x6b, 0x69, 0x2f, 0x63, 0x72, 0x6c, 0x2f, 0x70,
+          0x72, 0x6f, 0x64, 0x75, 0x63, 0x74, 0x73, 0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f, 0x72, 0x54, 0x68,
+          0x69, 0x50, 0x61, 0x72, 0x4d, 0x61, 0x72, 0x52, 0x6f, 0x6f, 0x5f, 0x32, 0x30, 0x31, 0x30, 0x2d,
+          0x31, 0x30, 0x2d, 0x30, 0x35, 0x2e, 0x63, 0x72, 0x6c, 0x30, 0x60, 0x06, 0x08, 0x2b, 0x06, 0x01,
+          0x05, 0x05, 0x07, 0x01, 0x01, 0x04, 0x54, 0x30, 0x52, 0x30, 0x50, 0x06, 0x08, 0x2b, 0x06, 0x01,
+          0x05, 0x05, 0x07, 0x30, 0x02, 0x86, 0x44, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x77, 0x77,
+          0x77, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f,
+          0x70, 0x6b, 0x69, 0x2f, 0x63, 0x65, 0x72, 0x74, 0x73, 0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f, 0x72,
+          0x54, 0x68, 0x69, 0x50, 0x61, 0x72, 0x4d, 0x61, 0x72, 0x52, 0x6f, 0x6f, 0x5f, 0x32, 0x30, 0x31,
+          0x30, 0x2d, 0x31, 0x30, 0x2d, 0x30, 0x35, 0x2e, 0x63, 0x72, 0x74, 0x30, 0x0d, 0x06, 0x09, 0x2a,
+          0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82, 0x02, 0x01, 0x00, 0xd4,
+          0x84, 0x88, 0xf5, 0x14, 0x94, 0x18, 0x02, 0xca, 0x2a, 0x3c, 0xfb, 0x2a, 0x92, 0x1c, 0x0c, 0xd7,
+          0xa0, 0xd1, 0xf1, 0xe8, 0x52, 0x66, 0xa8, 0xee, 0xa2, 0xb5, 0x75, 0x7a, 0x90, 0x00, 0xaa, 0x2d,
+          0xa4, 0x76, 0x5a, 0xea, 0x79, 0xb7, 0xb9, 0x37, 0x6a, 0x51, 0x7b, 0x10, 0x64, 0xf6, 0xe1, 0x64,
+          0xf2, 0x02, 0x67, 0xbe, 0xf7, 0xa8, 0x1b, 0x78, 0xbd, 0xba, 0xce, 0x88, 0x58, 0x64, 0x0c, 0xd6,
+          0x57, 0xc8, 0x19, 0xa3, 0x5f, 0x05, 0xd6, 0xdb, 0xc6, 0xd0, 0x69, 0xce, 0x48, 0x4b, 0x32, 0xb7,
+          0xeb, 0x5d, 0xd2, 0x30, 0xf5, 0xc0, 0xf5, 0xb8, 0xba, 0x78, 0x07, 0xa3, 0x2b, 0xfe, 0x9b, 0xdb,
+          0x34, 0x56, 0x84, 0xec, 0x82, 0xca, 0xae, 0x41, 0x25, 0x70, 0x9c, 0x6b, 0xe9, 0xfe, 0x90, 0x0f,
+          0xd7, 0x96, 0x1f, 0xe5, 0xe7, 0x94, 0x1f, 0xb2, 0x2a, 0x0c, 0x8d, 0x4b, 0xff, 0x28, 0x29, 0x10,
+          0x7b, 0xf7, 0xd7, 0x7c, 0xa5, 0xd1, 0x76, 0xb9, 0x05, 0xc8, 0x79, 0xed, 0x0f, 0x90, 0x92, 0x9c,
+          0xc2, 0xfe, 0xdf, 0x6f, 0x7e, 0x6c, 0x0f, 0x7b, 0xd4, 0xc1, 0x45, 0xdd, 0x34, 0x51, 0x96, 0x39,
+          0x0f, 0xe5, 0x5e, 0x56, 0xd8, 0x18, 0x05, 0x96, 0xf4, 0x07, 0xa6, 0x42, 0xb3, 0xa0, 0x77, 0xfd,
+          0x08, 0x19, 0xf2, 0x71, 0x56, 0xcc, 0x9f, 0x86, 0x23, 0xa4, 0x87, 0xcb, 0xa6, 0xfd, 0x58, 0x7e,
+          0xd4, 0x69, 0x67, 0x15, 0x91, 0x7e, 0x81, 0xf2, 0x7f, 0x13, 0xe5, 0x0d, 0x8b, 0x8a, 0x3c, 0x87,
+          0x84, 0xeb, 0xe3, 0xce, 0xbd, 0x43, 0xe5, 0xad, 0x2d, 0x84, 0x93, 0x8e, 0x6a, 0x2b, 0x5a, 0x7c,
+          0x44, 0xfa, 0x52, 0xaa, 0x81, 0xc8, 0x2d, 0x1c, 0xbb, 0xe0, 0x52, 0xdf, 0x00, 0x11, 0xf8, 0x9a,
+          0x3d, 0xc1, 0x60, 0xb0, 0xe1, 0x33, 0xb5, 0xa3, 0x88, 0xd1, 0x65, 0x19, 0x0a, 0x1a, 0xe7, 0xac,
+          0x7c, 0xa4, 0xc1, 0x82, 0x87, 0x4e, 0x38, 0xb1, 0x2f, 0x0d, 0xc5, 0x14, 0x87, 0x6f, 0xfd, 0x8d,
+          0x2e, 0xbc, 0x39, 0xb6, 0xe7, 0xe6, 0xc3, 0xe0, 0xe4, 0xcd, 0x27, 0x84, 0xef, 0x94, 0x42, 0xef,
+          0x29, 0x8b, 0x90, 0x46, 0x41, 0x3b, 0x81, 0x1b, 0x67, 0xd8, 0xf9, 0x43, 0x59, 0x65, 0xcb, 0x0d,
+          0xbc, 0xfd, 0x00, 0x92, 0x4f, 0xf4, 0x75, 0x3b, 0xa7, 0xa9, 0x24, 0xfc, 0x50, 0x41, 0x40, 0x79,
+          0xe0, 0x2d, 0x4f, 0x0a, 0x6a, 0x27, 0x76, 0x6e, 0x52, 0xed, 0x96, 0x69, 0x7b, 0xaf, 0x0f, 0xf7,
+          0x87, 0x05, 0xd0, 0x45, 0xc2, 0xad, 0x53, 0x14, 0x81, 0x1f, 0xfb, 0x30, 0x04, 0xaa, 0x37, 0x36,
+          0x61, 0xda, 0x4a, 0x69, 0x1b, 0x34, 0xd8, 0x68, 0xed, 0xd6, 0x02, 0xcf, 0x6c, 0x94, 0x0c, 0xd3,
+          0xcf, 0x6c, 0x22, 0x79, 0xad, 0xb1, 0xf0, 0xbc, 0x03, 0xa2, 0x46, 0x60, 0xa9, 0xc4, 0x07, 0xc2,
+          0x21, 0x82, 0xf1, 0xfd, 0xf2, 0xe8, 0x79, 0x32, 0x60, 0xbf, 0xd8, 0xac, 0xa5, 0x22, 0x14, 0x4b,
+          0xca, 0xc1, 0xd8, 0x4b, 0xeb, 0x7d, 0x3f, 0x57, 0x35, 0xb2, 0xe6, 0x4f, 0x75, 0xb4, 0xb0, 0x60,
+          0x03, 0x22, 0x53, 0xae, 0x91, 0x79, 0x1d, 0xd6, 0x9b, 0x41, 0x1f, 0x15, 0x86, 0x54, 0x70, 0xb2,
+          0xde, 0x0d, 0x35, 0x0f, 0x7c, 0xb0, 0x34, 0x72, 0xba, 0x97, 0x60, 0x3b, 0xf0, 0x79, 0xeb, 0xa2,
+          0xb2, 0x1c, 0x5d, 0xa2, 0x16, 0xb8, 0x87, 0xc5, 0xe9, 0x1b, 0xf6, 0xb5, 0x97, 0x25, 0x6f, 0x38,
+          0x9f, 0xe3, 0x91, 0xfa, 0x8a, 0x79, 0x98, 0xc3, 0x69, 0x0e, 0xb7, 0xa3, 0x1c, 0x20, 0x05, 0x97,
+          0xf8, 0xca, 0x14, 0xae, 0x00, 0xd7, 0xc4, 0xf3, 0xc0, 0x14, 0x10, 0x75, 0x6b, 0x34, 0xa0, 0x1b,
+          0xb5, 0x99, 0x60, 0xf3, 0x5c, 0xb0, 0xc5, 0x57, 0x4e, 0x36, 0xd2, 0x32, 0x84, 0xbf, 0x9e, 0x31,
+          0x82, 0x01, 0xc4, 0x30, 0x82, 0x01, 0xc0, 0x02, 0x01, 0x01, 0x30, 0x81, 0x98, 0x30, 0x81, 0x80,
+          0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30,
+          0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74,
+          0x6f, 0x6e, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64,
+          0x6d, 0x6f, 0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x15, 0x4d,
+          0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61,
+          0x74, 0x69, 0x6f, 0x6e, 0x31, 0x2a, 0x30, 0x28, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x21, 0x4d,
+          0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61,
+          0x74, 0x69, 0x6f, 0x6e, 0x20, 0x4b, 0x45, 0x4b, 0x20, 0x43, 0x41, 0x20, 0x32, 0x30, 0x31, 0x31,
+          0x02, 0x13, 0x33, 0x00, 0x00, 0x00, 0x12, 0x6e, 0x4c, 0xf7, 0x64, 0x5c, 0xdb, 0x88, 0x81, 0x00,
+          0x00, 0x00, 0x00, 0x00, 0x12, 0x30, 0x0d, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04,
+          0x02, 0x01, 0x05, 0x00, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
+          0x01, 0x05, 0x00, 0x04, 0x82, 0x01, 0x00, 0x71, 0x21, 0x2c, 0x11, 0x9e, 0x23, 0xa7, 0x98, 0xe5,
+          0xb9, 0x43, 0x0f, 0x77, 0xd1, 0xe5, 0xc5, 0xc9, 0x4f, 0x0c, 0x45, 0xc8, 0x29, 0x5a, 0xf3, 0xb4,
+          0x99, 0x4f, 0x48, 0x8d, 0x24, 0x53, 0x35, 0xf1, 0x31, 0x6e, 0x83, 0x51, 0x03, 0x70, 0x3c, 0x59,
+          0xee, 0x05, 0xcb, 0x23, 0x53, 0xca, 0xbf, 0xaa, 0x11, 0xcd, 0xae, 0xde, 0x98, 0x3f, 0xd1, 0x75,
+          0xcc, 0x69, 0xdb, 0x1d, 0xf8, 0x1f, 0x09, 0x22, 0x41, 0x80, 0x8c, 0x33, 0x3b, 0x3c, 0x53, 0xb1,
+          0xdf, 0x1d, 0x50, 0xdc, 0x0e, 0x07, 0xc4, 0xad, 0x95, 0xc0, 0x97, 0xe3, 0xaf, 0x49, 0x31, 0x2a,
+          0x59, 0x41, 0x91, 0x40, 0x89, 0x60, 0x9c, 0x9f, 0x35, 0x01, 0x8e, 0xc1, 0x08, 0xfa, 0x8f, 0xd5,
+          0xfe, 0x25, 0xa2, 0xfc, 0xac, 0xf7, 0x4b, 0x81, 0x40, 0x27, 0x57, 0xc2, 0x5f, 0x41, 0x49, 0x9b,
+          0xdc, 0x7b, 0x8c, 0x05, 0xaa, 0x3e, 0x27, 0x99, 0x7b, 0xd1, 0x44, 0x8f, 0xff, 0x1e, 0xfc, 0x1e,
+          0xd3, 0x82, 0x08, 0xf6, 0xae, 0xe9, 0x8b, 0x4a, 0xd2, 0xce, 0xb8, 0xcb, 0xb4, 0xea, 0x23, 0xd8,
+          0xac, 0x1a, 0x1d, 0x6d, 0x8b, 0x79, 0x19, 0x67, 0x69, 0x28, 0x5d, 0xc9, 0xce, 0x70, 0x8f, 0x2c,
+          0x07, 0x70, 0xaa, 0x1a, 0x9f, 0x35, 0x03, 0x46, 0x37, 0x30, 0xb4, 0x4e, 0x47, 0x8b, 0x03, 0xf4,
+          0xf7, 0x45, 0x2a, 0x0a, 0x31, 0x5a, 0x0a, 0xc6, 0xe3, 0x45, 0x20, 0x05, 0x6a, 0x83, 0xd5, 0x84,
+          0x49, 0xbf, 0xa7, 0x4b, 0xd6, 0x12, 0xf7, 0x5f, 0x92, 0x37, 0x66, 0xda, 0x3e, 0xfe, 0xa8, 0x2b,
+          0xe9, 0x17, 0x33, 0x1b, 0x32, 0x47, 0xfd, 0x7d, 0x99, 0x8d, 0x54, 0x6e, 0x96, 0x3b, 0xb9, 0x91,
+          0x45, 0x7c, 0x94, 0x57, 0xe4, 0xed, 0x93, 0x67, 0x46, 0x36, 0x93, 0x5a, 0xf7, 0x22, 0x17, 0x74,
+          0xc7, 0x36, 0x92, 0x8b, 0xc4, 0x5e, 0xdc};
+
+//
+// KEK: "Microsoft Corporation KEK CA 2011".
+//
+GLOBAL_REMOVE_IF_UNREFERENCED CONST UINT8 MicrosoftKekCa[] = {
+  0x30, 0x82, 0x05, 0xe8, 0x30, 0x82, 0x03, 0xd0, 0xa0, 0x03, 0x02, 0x01, 0x02,
+  0x02, 0x0a, 0x61, 0x0a, 0xd1, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x30,
+  0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05,
+  0x00, 0x30, 0x81, 0x91, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
+  0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08,
+  0x13, 0x0a, 0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74, 0x6f, 0x6e, 0x31,
+  0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64,
+  0x6d, 0x6f, 0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a,
+  0x13, 0x15, 0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43,
+  0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x31, 0x3b, 0x30,
+  0x39, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x32, 0x4d, 0x69, 0x63, 0x72, 0x6f,
+  0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74,
+  0x69, 0x6f, 0x6e, 0x20, 0x54, 0x68, 0x69, 0x72, 0x64, 0x20, 0x50, 0x61, 0x72,
+  0x74, 0x79, 0x20, 0x4d, 0x61, 0x72, 0x6b, 0x65, 0x74, 0x70, 0x6c, 0x61, 0x63,
+  0x65, 0x20, 0x52, 0x6f, 0x6f, 0x74, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x31, 0x30,
+  0x36, 0x32, 0x34, 0x32, 0x30, 0x34, 0x31, 0x32, 0x39, 0x5a, 0x17, 0x0d, 0x32,
+  0x36, 0x30, 0x36, 0x32, 0x34, 0x32, 0x30, 0x35, 0x31, 0x32, 0x39, 0x5a, 0x30,
+  0x81, 0x80, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
+  0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
+  0x57, 0x61, 0x73, 0x68, 0x69, 0x6e, 0x67, 0x74, 0x6f, 0x6e, 0x31, 0x10, 0x30,
+  0x0e, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13, 0x07, 0x52, 0x65, 0x64, 0x6d, 0x6f,
+  0x6e, 0x64, 0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x15,
+  0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x20, 0x43, 0x6f, 0x72,
+  0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x31, 0x2a, 0x30, 0x28, 0x06,
+  0x03, 0x55, 0x04, 0x03, 0x13, 0x21, 0x4d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f,
+  0x66, 0x74, 0x20, 0x43, 0x6f, 0x72, 0x70, 0x6f, 0x72, 0x61, 0x74, 0x69, 0x6f,
+  0x6e, 0x20, 0x4b, 0x45, 0x4b, 0x20, 0x43, 0x41, 0x20, 0x32, 0x30, 0x31, 0x31,
+  0x30, 0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
+  0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82,
+  0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xc4, 0xe8, 0xb5, 0x8a, 0xbf, 0xad,
+  0x57, 0x26, 0xb0, 0x26, 0xc3, 0xea, 0xe7, 0xfb, 0x57, 0x7a, 0x44, 0x02, 0x5d,
+  0x07, 0x0d, 0xda, 0x4a, 0xe5, 0x74, 0x2a, 0xe6, 0xb0, 0x0f, 0xec, 0x6d, 0xeb,
+  0xec, 0x7f, 0xb9, 0xe3, 0x5a, 0x63, 0x32, 0x7c, 0x11, 0x17, 0x4f, 0x0e, 0xe3,
+  0x0b, 0xa7, 0x38, 0x15, 0x93, 0x8e, 0xc6, 0xf5, 0xe0, 0x84, 0xb1, 0x9a, 0x9b,
+  0x2c, 0xe7, 0xf5, 0xb7, 0x91, 0xd6, 0x09, 0xe1, 0xe2, 0xc0, 0x04, 0xa8, 0xac,
+  0x30, 0x1c, 0xdf, 0x48, 0xf3, 0x06, 0x50, 0x9a, 0x64, 0xa7, 0x51, 0x7f, 0xc8,
+  0x85, 0x4f, 0x8f, 0x20, 0x86, 0xce, 0xfe, 0x2f, 0xe1, 0x9f, 0xff, 0x82, 0xc0,
+  0xed, 0xe9, 0xcd, 0xce, 0xf4, 0x53, 0x6a, 0x62, 0x3a, 0x0b, 0x43, 0xb9, 0xe2,
+  0x25, 0xfd, 0xfe, 0x05, 0xf9, 0xd4, 0xc4, 0x14, 0xab, 0x11, 0xe2, 0x23, 0x89,
+  0x8d, 0x70, 0xb7, 0xa4, 0x1d, 0x4d, 0xec, 0xae, 0xe5, 0x9c, 0xfa, 0x16, 0xc2,
+  0xd7, 0xc1, 0xcb, 0xd4, 0xe8, 0xc4, 0x2f, 0xe5, 0x99, 0xee, 0x24, 0x8b, 0x03,
+  0xec, 0x8d, 0xf2, 0x8b, 0xea, 0xc3, 0x4a, 0xfb, 0x43, 0x11, 0x12, 0x0b, 0x7e,
+  0xb5, 0x47, 0x92, 0x6c, 0xdc, 0xe6, 0x04, 0x89, 0xeb, 0xf5, 0x33, 0x04, 0xeb,
+  0x10, 0x01, 0x2a, 0x71, 0xe5, 0xf9, 0x83, 0x13, 0x3c, 0xff, 0x25, 0x09, 0x2f,
+  0x68, 0x76, 0x46, 0xff, 0xba, 0x4f, 0xbe, 0xdc, 0xad, 0x71, 0x2a, 0x58, 0xaa,
+  0xfb, 0x0e, 0xd2, 0x79, 0x3d, 0xe4, 0x9b, 0x65, 0x3b, 0xcc, 0x29, 0x2a, 0x9f,
+  0xfc, 0x72, 0x59, 0xa2, 0xeb, 0xae, 0x92, 0xef, 0xf6, 0x35, 0x13, 0x80, 0xc6,
+  0x02, 0xec, 0xe4, 0x5f, 0xcc, 0x9d, 0x76, 0xcd, 0xef, 0x63, 0x92, 0xc1, 0xaf,
+  0x79, 0x40, 0x84, 0x79, 0x87, 0x7f, 0xe3, 0x52, 0xa8, 0xe8, 0x9d, 0x7b, 0x07,
+  0x69, 0x8f, 0x15, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x4f, 0x30,
+  0x82, 0x01, 0x4b, 0x30, 0x10, 0x06, 0x09, 0x2b, 0x06, 0x01, 0x04, 0x01, 0x82,
+  0x37, 0x15, 0x01, 0x04, 0x03, 0x02, 0x01, 0x00, 0x30, 0x1d, 0x06, 0x03, 0x55,
+  0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x62, 0xfc, 0x43, 0xcd, 0xa0, 0x3e, 0xa4,
+  0xcb, 0x67, 0x12, 0xd2, 0x5b, 0xd9, 0x55, 0xac, 0x7b, 0xcc, 0xb6, 0x8a, 0x5f,
+  0x30, 0x19, 0x06, 0x09, 0x2b, 0x06, 0x01, 0x04, 0x01, 0x82, 0x37, 0x14, 0x02,
+  0x04, 0x0c, 0x1e, 0x0a, 0x00, 0x53, 0x00, 0x75, 0x00, 0x62, 0x00, 0x43, 0x00,
+  0x41, 0x30, 0x0b, 0x06, 0x03, 0x55, 0x1d, 0x0f, 0x04, 0x04, 0x03, 0x02, 0x01,
+  0x86, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x05,
+  0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
+  0x18, 0x30, 0x16, 0x80, 0x14, 0x45, 0x66, 0x52, 0x43, 0xe1, 0x7e, 0x58, 0x11,
+  0xbf, 0xd6, 0x4e, 0x9e, 0x23, 0x55, 0x08, 0x3b, 0x3a, 0x22, 0x6a, 0xa8, 0x30,
+  0x5c, 0x06, 0x03, 0x55, 0x1d, 0x1f, 0x04, 0x55, 0x30, 0x53, 0x30, 0x51, 0xa0,
+  0x4f, 0xa0, 0x4d, 0x86, 0x4b, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x63,
+  0x72, 0x6c, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74, 0x2e,
+  0x63, 0x6f, 0x6d, 0x2f, 0x70, 0x6b, 0x69, 0x2f, 0x63, 0x72, 0x6c, 0x2f, 0x70,
+  0x72, 0x6f, 0x64, 0x75, 0x63, 0x74, 0x73, 0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f,
+  0x72, 0x54, 0x68, 0x69, 0x50, 0x61, 0x72, 0x4d, 0x61, 0x72, 0x52, 0x6f, 0x6f,
+  0x5f, 0x32, 0x30, 0x31, 0x30, 0x2d, 0x31, 0x30, 0x2d, 0x30, 0x35, 0x2e, 0x63,
+  0x72, 0x6c, 0x30, 0x60, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05, 0x07, 0x01,
+  0x01, 0x04, 0x54, 0x30, 0x52, 0x30, 0x50, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
+  0x05, 0x07, 0x30, 0x02, 0x86, 0x44, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f,
+  0x77, 0x77, 0x77, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74,
+  0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x70, 0x6b, 0x69, 0x2f, 0x63, 0x65, 0x72, 0x74,
+  0x73, 0x2f, 0x4d, 0x69, 0x63, 0x43, 0x6f, 0x72, 0x54, 0x68, 0x69, 0x50, 0x61,
+  0x72, 0x4d, 0x61, 0x72, 0x52, 0x6f, 0x6f, 0x5f, 0x32, 0x30, 0x31, 0x30, 0x2d,
+  0x31, 0x30, 0x2d, 0x30, 0x35, 0x2e, 0x63, 0x72, 0x74, 0x30, 0x0d, 0x06, 0x09,
+  0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x0b, 0x05, 0x00, 0x03, 0x82,
+  0x02, 0x01, 0x00, 0xd4, 0x84, 0x88, 0xf5, 0x14, 0x94, 0x18, 0x02, 0xca, 0x2a,
+  0x3c, 0xfb, 0x2a, 0x92, 0x1c, 0x0c, 0xd7, 0xa0, 0xd1, 0xf1, 0xe8, 0x52, 0x66,
+  0xa8, 0xee, 0xa2, 0xb5, 0x75, 0x7a, 0x90, 0x00, 0xaa, 0x2d, 0xa4, 0x76, 0x5a,
+  0xea, 0x79, 0xb7, 0xb9, 0x37, 0x6a, 0x51, 0x7b, 0x10, 0x64, 0xf6, 0xe1, 0x64,
+  0xf2, 0x02, 0x67, 0xbe, 0xf7, 0xa8, 0x1b, 0x78, 0xbd, 0xba, 0xce, 0x88, 0x58,
+  0x64, 0x0c, 0xd6, 0x57, 0xc8, 0x19, 0xa3, 0x5f, 0x05, 0xd6, 0xdb, 0xc6, 0xd0,
+  0x69, 0xce, 0x48, 0x4b, 0x32, 0xb7, 0xeb, 0x5d, 0xd2, 0x30, 0xf5, 0xc0, 0xf5,
+  0xb8, 0xba, 0x78, 0x07, 0xa3, 0x2b, 0xfe, 0x9b, 0xdb, 0x34, 0x56, 0x84, 0xec,
+  0x82, 0xca, 0xae, 0x41, 0x25, 0x70, 0x9c, 0x6b, 0xe9, 0xfe, 0x90, 0x0f, 0xd7,
+  0x96, 0x1f, 0xe5, 0xe7, 0x94, 0x1f, 0xb2, 0x2a, 0x0c, 0x8d, 0x4b, 0xff, 0x28,
+  0x29, 0x10, 0x7b, 0xf7, 0xd7, 0x7c, 0xa5, 0xd1, 0x76, 0xb9, 0x05, 0xc8, 0x79,
+  0xed, 0x0f, 0x90, 0x92, 0x9c, 0xc2, 0xfe, 0xdf, 0x6f, 0x7e, 0x6c, 0x0f, 0x7b,
+  0xd4, 0xc1, 0x45, 0xdd, 0x34, 0x51, 0x96, 0x39, 0x0f, 0xe5, 0x5e, 0x56, 0xd8,
+  0x18, 0x05, 0x96, 0xf4, 0x07, 0xa6, 0x42, 0xb3, 0xa0, 0x77, 0xfd, 0x08, 0x19,
+  0xf2, 0x71, 0x56, 0xcc, 0x9f, 0x86, 0x23, 0xa4, 0x87, 0xcb, 0xa6, 0xfd, 0x58,
+  0x7e, 0xd4, 0x69, 0x67, 0x15, 0x91, 0x7e, 0x81, 0xf2, 0x7f, 0x13, 0xe5, 0x0d,
+  0x8b, 0x8a, 0x3c, 0x87, 0x84, 0xeb, 0xe3, 0xce, 0xbd, 0x43, 0xe5, 0xad, 0x2d,
+  0x84, 0x93, 0x8e, 0x6a, 0x2b, 0x5a, 0x7c, 0x44, 0xfa, 0x52, 0xaa, 0x81, 0xc8,
+  0x2d, 0x1c, 0xbb, 0xe0, 0x52, 0xdf, 0x00, 0x11, 0xf8, 0x9a, 0x3d, 0xc1, 0x60,
+  0xb0, 0xe1, 0x33, 0xb5, 0xa3, 0x88, 0xd1, 0x65, 0x19, 0x0a, 0x1a, 0xe7, 0xac,
+  0x7c, 0xa4, 0xc1, 0x82, 0x87, 0x4e, 0x38, 0xb1, 0x2f, 0x0d, 0xc5, 0x14, 0x87,
+  0x6f, 0xfd, 0x8d, 0x2e, 0xbc, 0x39, 0xb6, 0xe7, 0xe6, 0xc3, 0xe0, 0xe4, 0xcd,
+  0x27, 0x84, 0xef, 0x94, 0x42, 0xef, 0x29, 0x8b, 0x90, 0x46, 0x41, 0x3b, 0x81,
+  0x1b, 0x67, 0xd8, 0xf9, 0x43, 0x59, 0x65, 0xcb, 0x0d, 0xbc, 0xfd, 0x00, 0x92,
+  0x4f, 0xf4, 0x75, 0x3b, 0xa7, 0xa9, 0x24, 0xfc, 0x50, 0x41, 0x40, 0x79, 0xe0,
+  0x2d, 0x4f, 0x0a, 0x6a, 0x27, 0x76, 0x6e, 0x52, 0xed, 0x96, 0x69, 0x7b, 0xaf,
+  0x0f, 0xf7, 0x87, 0x05, 0xd0, 0x45, 0xc2, 0xad, 0x53, 0x14, 0x81, 0x1f, 0xfb,
+  0x30, 0x04, 0xaa, 0x37, 0x36, 0x61, 0xda, 0x4a, 0x69, 0x1b, 0x34, 0xd8, 0x68,
+  0xed, 0xd6, 0x02, 0xcf, 0x6c, 0x94, 0x0c, 0xd3, 0xcf, 0x6c, 0x22, 0x79, 0xad,
+  0xb1, 0xf0, 0xbc, 0x03, 0xa2, 0x46, 0x60, 0xa9, 0xc4, 0x07, 0xc2, 0x21, 0x82,
+  0xf1, 0xfd, 0xf2, 0xe8, 0x79, 0x32, 0x60, 0xbf, 0xd8, 0xac, 0xa5, 0x22, 0x14,
+  0x4b, 0xca, 0xc1, 0xd8, 0x4b, 0xeb, 0x7d, 0x3f, 0x57, 0x35, 0xb2, 0xe6, 0x4f,
+  0x75, 0xb4, 0xb0, 0x60, 0x03, 0x22, 0x53, 0xae, 0x91, 0x79, 0x1d, 0xd6, 0x9b,
+  0x41, 0x1f, 0x15, 0x86, 0x54, 0x70, 0xb2, 0xde, 0x0d, 0x35, 0x0f, 0x7c, 0xb0,
+  0x34, 0x72, 0xba, 0x97, 0x60, 0x3b, 0xf0, 0x79, 0xeb, 0xa2, 0xb2, 0x1c, 0x5d,
+  0xa2, 0x16, 0xb8, 0x87, 0xc5, 0xe9, 0x1b, 0xf6, 0xb5, 0x97, 0x25, 0x6f, 0x38,
+  0x9f, 0xe3, 0x91, 0xfa, 0x8a, 0x79, 0x98, 0xc3, 0x69, 0x0e, 0xb7, 0xa3, 0x1c,
+  0x20, 0x05, 0x97, 0xf8, 0xca, 0x14, 0xae, 0x00, 0xd7, 0xc4, 0xf3, 0xc0, 0x14,
+  0x10, 0x75, 0x6b, 0x34, 0xa0, 0x1b, 0xb5, 0x99, 0x60, 0xf3, 0x5c, 0xb0, 0xc5,
+  0x57, 0x4e, 0x36, 0xd2, 0x32, 0x84, 0xbf, 0x9e
+};
 
 //
 // Password-protected PEM Key data for RSA Private Key Retrieving (encryption key is "client").
@@ -18,7 +356,7 @@
 // $ xxd --include TestKeyPem
 //
 GLOBAL_REMOVE_IF_UNREFERENCED CONST UINT8 TestKeyPem[] = {
-   0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, 0x49, 0x4e, 0x20, 0x52,
+  0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x42, 0x45, 0x47, 0x49, 0x4e, 0x20, 0x52,
   0x53, 0x41, 0x20, 0x50, 0x52, 0x49, 0x56, 0x41, 0x54, 0x45, 0x20, 0x4b,
   0x45, 0x59, 0x2d, 0x2d, 0x2d, 0x2d, 0x2d, 0x0a, 0x50, 0x72, 0x6f, 0x63,
   0x2d, 0x54, 0x79, 0x70, 0x65, 0x3a, 0x20, 0x34, 0x2c, 0x45, 0x4e, 0x43,
@@ -396,6 +734,101 @@ TestVerifyPkcs7SignVerify (
   return UNIT_TEST_PASSED;
 }
 
+UNIT_TEST_STATUS
+EFIAPI
+TestPkcs7GetSigners (
+  IN UNIT_TEST_CONTEXT           Context
+  )
+{
+  BOOLEAN                          Status;
+  UINT8                            *TopLevelCert;
+  UINTN                            TopLevelCertSize;
+  UINT8                            *SignerCerts;
+  UINTN                            CertStackSize;
+
+  SignerCerts            = NULL;
+  TopLevelCert           = NULL;
+
+  Status = Pkcs7GetSigners (
+                   ExampleMicrosoftKekPkcs7Signature,
+                   sizeof(ExampleMicrosoftKekPkcs7Signature),
+                   &SignerCerts,
+                   &CertStackSize,
+                   &TopLevelCert,
+                   &TopLevelCertSize
+                   );
+
+  /* ***************************************************************************************
+  // The following is from VerifyTimeBasedPayload() in AuthService.c
+  // ***************************************************************************************
+  //
+  // // 1. TopLevelCert is the top-level issuer certificate in signature Signer Cert Chain
+  //
+  // ...
+  //
+  //      //
+  //      // Check hash of signer cert CommonName + Top-level issuer tbsCertificate against data in CertDb
+  //      //
+  //      CertDataPtr = (EFI_CERT_DATA *)(SignerCerts + 1);
+  //      Status = CalculatePrivAuthVarSignChainSHA256Digest(
+  //                 CertDataPtr->CertDataBuffer,
+  //                 ReadUnaligned32 ((UINT32 *)&(CertDataPtr->CertDataLength)),
+  //                 TopLevelCert,
+  //                 TopLevelCertSize,
+  //                 Sha256Digest
+  //                 );
+  //
+  // ***************************************************************************************
+  // The above implies that the first cert in SignerCerts should be the leaf signer, and
+  //   TopLevelCert should be the top level issuer.
+  //
+  // EXPECTED:
+  // TopLevelCert is "Microsoft Corporation KEK CA 2011"
+  // SignerCerts holds 2 certificates, the cert chain, both the CA and the leaf "Microsoft Windows UEFI Key Exchange Key"
+  //
+  // OBSERVED:
+  // TopLevelCert is "Microsoft Windows UEFI Key Exchange Key"
+  // SignerCerts holds 1 certificates, just the leaf "Microsoft Windows UEFI Key Exchange Key"
+  //
+  // NOTES:
+  // VerifyTimeBasedPayload() appears to have misunderstood the OUT parameters of Pkcs7GetSigners().
+  // Pkcs7GetSigners() does _NOT_ return the signer's sorted certificate chain.
+  // Pkcs7GetSigners() returns the stack of SignerInfo's, of which there is typically 1,
+  //   but can be more if an object is signed by multiple entities (e.g. Microsoft and RedHat).
+  //   Refer to PKCS7_get0_signers().  We cannot trust the Certificates in the P7 until we verify it, and even
+  //   then, we likely should build the chain using OpenSSL, not trust any ordering of the Certificates in the P7
+  //   Reference the show_chain flag in OpenSSL's verify.c app.
+  //
+  // The below 2 misuses of this function appear to break the ability to revoke by cert hash for intermediate and top level certs:
+  // P7CheckRevocationByHash() in Pkcs7VerifyDxe.c also assumes Pkcs7GetSigners() returns the sorted cert chain...
+  // IsForbiddenByDbx() in DxeImageVerificationLib.c also assumes Pkcs7GetSigners() returns the sorted cert chain...
+  //
+  // BROKEN SCENARIOS:
+  // 1. SECURITY: The ability to revoke any intermediate or top level cert by certificate hash
+  // 2. The ability to modify private authenticated variables using a new leaf cert issued under the "top level CA",
+  //      because it is "pinning" to the leaf due to incorrect use (or implementation) of Pkcs7GetSigners()
+  //
+  // **************************************************************************************/
+
+  UT_ASSERT_TRUE (Status);
+  UT_ASSERT_NOT_NULL (SignerCerts);
+  UT_ASSERT_NOT_EQUAL (CertStackSize, 0);
+
+  CONST UINT8 NumberOfCerts = *((UINT8*) SignerCerts);
+  UT_ASSERT_EQUAL(NumberOfCerts, 2);  // there are 2 x509 certificates in the Certificates section
+
+  UT_ASSERT_NOT_NULL (TopLevelCert);
+  CONST UINTN SizeOfKekCaCert = sizeof(MicrosoftKekCa);
+  UT_ASSERT_EQUAL (TopLevelCertSize, SizeOfKekCaCert);
+  UT_ASSERT_MEM_EQUAL(TopLevelCertSize, MicrosoftKekCa, sizeof(MicrosoftKekCa));
+
+  Pkcs7FreeSigners(SignerCerts);
+  Pkcs7FreeSigners(TopLevelCert);
+
+  return UNIT_TEST_PASSED;
+}
+
+
 TEST_DESC mRsaCertTest[] = {
     //
     // -----Description--------------------------------------Class----------------------Function-----------------Pre---Post--Context
@@ -410,6 +843,7 @@ TEST_DESC mPkcs7Test[] = {
     // -----Description--------------------------------------Class----------------------Function-----------------Pre---Post--Context
     //
     {"TestVerifyPkcs7SignVerify()",        "CryptoPkg.BaseCryptLib.Pkcs7",   TestVerifyPkcs7SignVerify,        NULL, NULL, NULL},
+    {"TestPkcs7GetSigners()",              "CryptoPkg.BaseCryptLib.Pkcs7",   TestPkcs7GetSigners,              NULL, NULL, NULL},
 };
 
 UINTN mPkcs7TestNum = ARRAY_SIZE(mPkcs7Test);
-- 
2.30.0.windows.2

